{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"ccna/","text":"Ethernet and Frames Unicast frames: For just one host Broadcast frames: ff:ff:ff:ff:ff:ff - For all devices on a single internet LAN. Multicast frames: Forwarded to a subnet for the hosts on a ethernet LAN. Ethernet \"Type\" field 0800 = IPv4 86DD = IPv6 Hub = port needs to be at half-duplex Cisco Security User and access management Enable secret takes precedence over enable password. enable password potato enable secret potato2 enable password = potato2 Enable AAA (allow user with privilege 15 to login straight into enable mode) conf t aaa new - model aaa authentication login default group local aaa authorization exec default group local Create user with default privilege 15 level conf t username $ USERNAME privilege 15 secret $ PASSWORD login = password and username of the vty itself. login local = Local username database conf t line con 0 login local exec - timeout 0 0 logging synchronous Line VTY user are set to privilege 15 automatically. conf t line vty 0 15 privilege level 15 \"Encrypt\" passwords in the startup-config. service password - encryption Port-Security Enabling port security on port Cannot be enabled on a trunk/dynamic/auto port. Must be an access port. conf t interface gigabitethernet0 / 1 switchport port - security Keep MAC addresses when port-shutdown or switch reload. conf t interface gigabitethernet0 / 1 switchport port - security switchport port - security mac - address sticky MAC aging Dynamic MAC aging default = 0 absolute timer = Counts down irregardless of traffic inactivity timer = resets when traffic is seen from MAC. maximum - Default 1 If you raise the number of max MAC addresses on a port, you can run static and dynamic MAC detection. MAC address conversion Character HEX a 10 b 11 c 12 d 13 e 14 f 15 One digit hex ---> 0-9 or A-F Two digit hex ---> Left to Right, units of 16 ---> units of 1. Hexadecimal A7 to decimal A = 10 units of 16 (A=16) ---> 160 7 = 7 units of 1 ---> 7 160 + 7 = 167 Decimal 241 to Hexadecimal 1. f = 15 * 16 2. 1 = 1 * 1 3. F1 Violation option protect - Drops traffic, no SYSLOG, no SNMP Trap, no counters increased restrict - Drops traffic, generate SNMP trap, generate SYSLOG. shutdown - Default, increase violation counters, Port shutdown in error-disabled. Show port-security commands show port - security interface fastethernet 0 / 1 show port - security address Error disabled recovery Default recovery 300 seconds conf t errordisable recovery cause ? errordisable recovery cause psecure - violation errdisable recovery interval 30 show errdisable recovery VLAN interfaces (SVI) Layer 2 vlan must exist Physical interface with vlan attached to must be in UP and UP. Can be a trunk with vlan allowed or an access port with the vlan. Autonegociation - Speed and Duplex Highest speed supported by both is used. Full duplex supported by both is used. DO NOT set one side auto and the other side forced. Symptoms --> Slow Upload, irregular speed, packet loss, CRC/Runt frames errors on the interface Interface range interface range fastethernet 0 / 1 - 24 interface range fastethernet 0 / 1 - 24 , 25 , 26 TCP and UDP TCP Guarantees delivery of segments Error Detection and recovery Sequence numbers and ACK to recover from lost/corrupt packets TCP Windowing Connection-oriented Three-way handshake SYN FLAG / ACK FLAG Source ---> Destination : SYN Destination ---> Source : SYN-ACK Source ---> Destination : ACK Connection Established When connection is terminated - 4 Way Handshake Client ---> Server : FIN, ACK Client <--- Server : ACK Client <--- Server : ACK, FIN Client ---> Server : ACK Flow control and Windowing The receiver increases the Window size / controls the flow. The receiver asks for more data when traffic flows well --> No errors/retransmits on packets. UDP \"Best Effort\" No Error Detection No Windowing Connectionless - Data is sent without the remote peer being aware. Port Numbers Well-known port numbers: Protocol / Transport Port HTTPS / TCP 443 SNMP / UDP 161 SMTP / TCP 25 TELNET / TCP 22 SSH / TCP 23 Socket ---> Combination of an ipaddress and a port number. 192.168.1.1:10000 DHCP DORA 1. Discover - Broadcast from client. 2. Offer - DHCP server receives Discover and sends unicast offer to client. 3. Request - Client sends request for the offered IP address. 4. Ack - DHCP server ack the client request and assigns the IP. Routing - Static Routes ip route destination_subnet destination_mask [ local - router - exit - interface | next - hop - ip - address ] ip route 2 . 2 . 2 . 2 255 . 255 . 255 . 0 192 . 168 . 1 . 1 # Default Route ip route 0 . 0 . 0 . 0 0 . 0 . 0 . 0 [ local - router - exit - interface | next - hop - ip - address ] Routing - Distance Vector Protocols - RIP RIPv1 / IGRP Full route table update at fixed interval. Every 30 seconds for RIP. Do not subnet VLSM. No Packet authentication. RIPv2 Supports VLSM. Multicasts from router updates - 224.0.0.9 instead of broadcast (RIPv1) Supports Authentication. Supports route summarization. Split Horizon A route cannot be advertised via an interface that received the route in the first place. No split horizon on frame-relay. Route Poisoning When all routers have the same routing table --> State of convergence Slow to converge When router removes a subnet that is local to itself. Send update that shows 16 hops for the removed subnet. Other routers will receive the update and remove the route from their own routing tables as 16 hops marks a subnet as unreachable. Hops Metric for RIPv2. Measures of distance to reach a specific subnet. Does not care about interface speed - only hop count. Enabling RIPv2 conf t router rip # Show protocols active on router show ip protocols # Enable specific version of RIPv2 per interface or global . interface gig0 / 1 ip rip send version 2 conf t router rip rip version 2 network 10 . 10 . 10 . 0 network 10 . 10 . 11 . 0 # Disable auto summary conf t router rip no auto - summary # Enable split Horizon interface serial0 / 1 / 0 ip split - horizon Confirming that RIPV2 works. show ip protocols show ip rip database Clear RIP routes. clear ip route * Passive interfaces Prevents sending RIPv2 updates from interfaces where it's not necessary. conf t router rip passive - interface fastethernet0 / 1 passive - interface fastethernet0 / 2 conf t router rip passive - interface default no passive - interface fastethernet0 / 1 no passive - interface fastethernet0 / 2 RIP Load Balancing 1) If a subnet is reachable through two paths with the same hope count --> Load balance across the two links. Disabling equal cost load balancing conf t router rip maximum - path 1 Default route in RIP conf t router rip default - information originate Routing Administrative distance 1) The prefix mask is considered first. The more specific route is installed. 2) If the prefix max is \"=\" ---> Administrative Distance is checked. The route with the lowest ADs wins. Floating static routes If a route with a lower AD is removed from the routing table, the static route will be added and become active. conf t ip route 2 . 2 . 2 . 0 255 . 255 . 255 . 0 21 . 1 . 1 . 2 [ static route metric here | higher than routing protocol 1 - 255 ] Subnetting 128 64 32 16 8 4 2 1 45 0 0 0 0 1 1 0 1 200.17.100.3 128 64 32 16 8 4 2 1 200 1 1 0 0 1 0 0 0 17 0 0 0 1 0 0 0 1 100 0 1 1 0 0 1 0 0 3 0 0 0 0 0 0 1 1 11001000.00010001.01100100.00000011 Network class Class A Class B Class C 1st Octet range 1 - 126 128 - 191 192 - 223 Network Mask 255.0.0.0 - /8 255.255.0.0 - /16 255.255.255.0 - /24 Number of subnet in a network - 200.1.1.0 /27 Find the class of the subnet --> Class C (+192) A class C is a /24 by default. /27 - /24 = 3 subnet bits. Number of subnet --> 2^Number_subnet_bits_remaining --> 2^3 --> 2 * 2 * 2 = 8 subnets Number of hosts per subnet - 200.1.1.0 /27 Find the number of host bits --> /32 - /27 --> /5 host bits Find the number of valid host per subnet - remove subnet and broadcast address. (2^(number of host bits))-2 --> 2^5 --> 2 * 2 * 2 * 2 * 2 --> 32 - 2 --> 30 Find the Subnet of an IP address - 10.17.2.14/18 /18 = First two octets = 16 bits + 2 bits from third octet 10.17.00000010 10.17. 00 000000 --> Total of 18 bits for subnet address Subnet address = 10.17.0.0/18 Find the broadcast and range of valid addresses in subnet - 210.46.110.0 /25 /32 - /25 = last 7 bits --> host bits 01111111 --> 64 + 32 +16 +8 + 4 + 2 +1 --> 96 + 16 + 15 --> 96 + 31 --> Broadcast = 210.46.110.127 Find the broadcast and range of valid addresses in subnet - 150.10.64.0 /18 /32 - /18 = last 14 bits --> host bits 128 64 32 16 8 4 2 1 64 0 1 0 0 0 0 0 0 Broadcast --> 150.10.0 1111111.11111111 --> 150.10.127.255 Range of valid addresses --> 150.10.64.1 to 150.10.127.254 Access Lists All ACL have an implicit DENY ALL ALL at the end. The search is done TOP to BOTTOM When a match is found, that's the end of the search. Any remaining lines are not examined. Wildcard masks 0 --> All bits must match. 1 --> Does not need to match. Standard ACL Can only match on the SOURCE ip address of a packet. Standard Access list number : 1 --> 99 Standard expanded access list number : 1300 --> 1999 < 1 - 99 > Standard IP access - list number < 1300 - 1999 > Standard IP access - list number ( expanded range ) WORD Access - list name ip access - list standard 5 deny 3 . 3 . 3 . 0 0 . 0 . 0 . 255 interface fastethernet0 ip access - group 5 in Extended ACL Can match on source AND/OR destination. Named Extended/Standard ACL Allows naming of Access list instead of number. Valid for Standard and Extended ACL. Cannot have an Extended and Standard ACL with the same name. You need to use ip access-list standard | extended instead of access-list conf t ip access - list extended BLOCK11 deny ip 3 . 3 . 3 . 0 0 . 0 . 0 . 255 11 . 11 . 11 . 0 0 . 0 . 0 . 255 permet ip any any ACL on VTY lines conf t line vty 0 14 access - class MGMT - NETWORKS in ACL Sequence numbers Allows moving and deletion of specific lines within the ACL. You cannot move or reassign a sequence number. You need to delete and recreate the line with the new sequence number. conf t ip access - list extended 101 no $ SEQUENCE_NUMVER Where to apply ACLs Apply Extended ACLs as close to the source of the traffic. Apply Standard ACL as close to the destination as possible. NTP - Network Time Protocol Creates a single source of time for all device on the network. UDP Port 123 Stratum - Level of accuracy of the NTP server. 0 --> Atomic clocks 1 --> Gets time from a stratum 0 NTP server. NTP Modes Master : Set the device itself as the master and will synch with itself to synchronize time. Peer : The two devices will dynamically synchronize time between the two. Server : The client device will ask time from the server. Does not send time synchronize requests to the server. Broadcast Mode : Broadcast mode for NTP packets. !*** Set the device itself as the master NTP server . conf t ntp master !*** Set the NTP server for the device . conf t ntp server ntp . nist . ca conf t ntp peer ntp . potato . com !*** Show all ntp services from which the device will sync it ' s clock. Also shows the preferred device. show ntp associations show ntp status show clock !*** Under device interface configuration . !*** Sets broadcast server mode ( send updates ) conf t interface serial 0 / 1 / 0 ntp broadcast !*** Set client broadcast mode conf t interface serial 0 / 1 / 0 ntp broadcast client NAT / PAT - Network Address Translation / Port Address Translation Local --> Private address Global --> Public routable address Inside Local --> Local Address being translated to External. Inside Global --> External Address that is used during the NAT. Outside Local --> Non-routable addresses of the host on the remote network. Outside Global --> Routable addresses of the host on the remote network. Static NAT One to one mapping of an Inside Local to a Inside Global. I.E : Map a public IP to the internal IP of a server. !*** Place on the interfaces closest to the hosts . ip nat inside !*** Place on the WAN interface . ip nat outside !*** Setup Static NAT / One to one mapping ip nat inside source static 10 . 1 . 1 . 2 200 . 1 . 1 . 1 !*** Show translations show ip nat translations !*** Show NAT statistics show ip nat statistics !*** clear ip nat table to reset the NAT mappings clear ip nat translations * Dynamic NAT Allow the NAT of a pool of internal address to a pool of outside addresses. !*** Create IP NAT Pool ip nat pool CCNA 200 . 1 . 1 . 1 200 . 1 . 1 . 5 prefix - length 24 !*** Create the access - list of internal host that will be NAT . access - list 2 permit host 10 . 1 . 1 . 2 access - list 2 permit host 10 . 1 . 1 . 22 !*** Create the NAT function for the access - list 2 and the pool CCNA ip nat inside source list 2 pool CCNA Port address translation - NAT Overload Allows the mapping of multiple inside addresses to a single outside address using a combination of the IP address / Port Number in ordre to uniquely identify each flow of data. !*** Overload of the inside addresses to the outside address ip nat inside source list 2 interface serial0 / 1 / 0 overload IPv6 Solution to the IPv4 exhaustion. 128 bit addresses 8 blocks of 4 HEX characters. No more broadcast - only multicasts. Easier summarization. Can be run without a DHCP server. IANA (Internet Assigned Numbers Authority) - Assigns IP blocks to RIR (Regional Internet Registry - ARIN, RIPE, AFRINIC, APNIC, LACNIC. Compressing IPv6 addresses Compress consecutive blocks of 0000 with :: Can only do once per IPv6 addresses Remove leading 0 in blocks. Assigning IPv6 addresses to interfaces ! ### Enable IPv6 Routing for the router . ipv6 unicast - routing ! ### Assign an IPv6 address to an interface interface fastethernet0 / 1 ipv6 address 2001 : 1111 : 2222 : 1 :: 1 / 64 Types of IPv6 addresses. There is no broadcast - only Unicast and Multicast. Global Unicast addresses Routable public addresses Link-local addresses : Addresses used in links directly. Routers will not route those packets. Addresses will always start FE80:0000:0000:0000 (FE80:/10) 64-bit interface identifier - EUI-64 process EUI-64 Process Take MAC address of the interface 11-22-33-aa-bb-cc Divide in half and insert FFFE. 11-22-33-FF-FE-AA-BB-CC 1122:33FF:FEAA:BBCC Do the bit inversion (invert the 7th bit of the address) 1122:33FF:FEAA:BBCC --> 1322:33FF:FEAA:BBCC Use EUI-64 process for global unicast address. ipv6 address 2001 : 1111 : 2222 : 1 :: / 64 eui - 64 IPv6 NDP - Neighbor Discovery Process Allows IPv6 enabled device to discover hosts and routers on an IPv6 enabled network. The discovery process is different for routers and hosts. NDP - Router Discovery Hosts multicast packet - Router Solicitation (RS) message - Destination address FF02::2 - All-IPv6-Routers address Routers receives RS on FF02::2 and sends RA (Router Advertisement). If the soliciting node HAS an IPv6 address --> RA is unicast to the host. If the soliciting node DOES NOT have an IPv6 address --> RA is sent to FF02::1 - \"All-IPV6-Nodes\" RA are also sent to FF02::1 every 200 seconds. FF02::1 --> All IPv6 hosts. NDP - Host Discovery NS --> Neighbor Solicitation. NA --> Neighbor Advertisement. NA is sent to SNMA - Solicited-node multicast address. Always begin with FF02::1:FF Contains the last 6 HEX characters of the interface mac address. That way only the relevant hosts will receive the requested NA. Host that receives the NA, add the entry to the NDP table - same purpose as the ARP table. DHCP and IPv6 Same basic functionality as IPv4 but two different types of DHCPv6 servers : Stateful and Stateless. Stateful DHCP SARR (instead of DORA) Solicit - Client Advertise - Server offers the address to the Client Request - Client request the previously offered lease to the server Reply - The Server confirms the lease to the client Stateful DHCP does not send \"Default Gateway\" in the DHCP lease. That part is discovered during the NDP process with NA and NS messages. Stateless DHCP Stateless autoconfiguration - SLAAC. Hosts will generate their own ip addresses from information received during the RA - RS process. RA messages will contain the subnet prefix and the prefix length. The host will then create it's own IP address adding it's own interface identifier at the end. IPv6 - Duplicate Address Detection - DAD Prevents duplicate addresses from being used on the network. 1. The host will send an NS (with the source address all :: - 128 zeros - unspecified ipv6 address) to the address it wants to use to FF02::1 (All IPV6 nodes) 2. If it gets a response, it means that a host is already using that address. IPv6 Packet Header Version : Set to 6 Traffic class : Replaces \"Type of Service\". Allow level of importance with QOS. Flow Label: NEW FIELD - Allow traffic priorities and categorization. Works with QOS and Traffic Class. Payload Length: Total length of packet Hop Limit : Like the TTL field of IPv4. Each hope decreases the counter by 1. Next Header : Equivalent to the Protocol field. Source Address : Source Address of the packet Destination Address : Destination Address of the packet Logging and Timestamps Change the aspect and format of timestamps for SYSLOG and DEBUG message. service timestamps log datetime ! ### Add year to log timestamps . service timestamps log datetime year ! ### Add millisecond to log timestamps . service timestamps log datetime msec service timestamps log datetime year msec show - timezone Logging to remote server Enable logging to the console. logging console Enable buffered logging. Local buffer on the server. logging buffer Enable logging to a remote server. logging host $ SYSLOG_SERVER_IPADDRESS Enable console logging on SSH/Telnet session conf t logging monitor exit terminal monitor Banner configuration Three types of banners. Login : Shown during the login prompt. Telnet and SSH. Exec : Shown after the user logs in. Telnet and SSH. MOTD : Shown along the login prompt. SSHv2 --> SHOWN AFTER LOGIN INTO THE DEVICE WITH EXEC BANNER. CDP - Cisco Discovery Protocol Default timers Hold Timer - 180 seconds - After 180 seconds, the entry is removed. Advertisement timer - 60 seconds. show cdp neighbors show cdp neighbors details show cdp entry $ REMOTE_DEVICE_HOSTNAME !*** Enable CDP globally . cdp run no cdp run !*** Enable CDP on an interface interface fastethernet0 / 0 cdp enable no cdp enable !*** Show CDP information show cdp information show cdp interface fastethernet 0 / 0 LLDP - Link Layer Discovery Protocols You can disable the received and transmit of LLDP packets per interface. That is not possible for CDP. show lldp conf t lldp run show lldp neighbor detail Confreg Register and Password Recovery RONMON mode --> Allow to boot IOS without reading the NVRAM router config. show version | include register config - register 0 x2142","title":"Cisco-CCNA"},{"location":"ccna/#ethernet-and-frames","text":"Unicast frames: For just one host Broadcast frames: ff:ff:ff:ff:ff:ff - For all devices on a single internet LAN. Multicast frames: Forwarded to a subnet for the hosts on a ethernet LAN.","title":"Ethernet and Frames"},{"location":"ccna/#ethernet-type-field","text":"0800 = IPv4 86DD = IPv6 Hub = port needs to be at half-duplex","title":"Ethernet \"Type\" field"},{"location":"ccna/#cisco-security","text":"","title":"Cisco Security"},{"location":"ccna/#user-and-access-management","text":"Enable secret takes precedence over enable password. enable password potato enable secret potato2 enable password = potato2 Enable AAA (allow user with privilege 15 to login straight into enable mode) conf t aaa new - model aaa authentication login default group local aaa authorization exec default group local Create user with default privilege 15 level conf t username $ USERNAME privilege 15 secret $ PASSWORD login = password and username of the vty itself. login local = Local username database conf t line con 0 login local exec - timeout 0 0 logging synchronous Line VTY user are set to privilege 15 automatically. conf t line vty 0 15 privilege level 15 \"Encrypt\" passwords in the startup-config. service password - encryption","title":"User and access management"},{"location":"ccna/#port-security","text":"Enabling port security on port Cannot be enabled on a trunk/dynamic/auto port. Must be an access port. conf t interface gigabitethernet0 / 1 switchport port - security Keep MAC addresses when port-shutdown or switch reload. conf t interface gigabitethernet0 / 1 switchport port - security switchport port - security mac - address sticky","title":"Port-Security"},{"location":"ccna/#mac-aging","text":"Dynamic MAC aging default = 0 absolute timer = Counts down irregardless of traffic inactivity timer = resets when traffic is seen from MAC. maximum - Default 1 If you raise the number of max MAC addresses on a port, you can run static and dynamic MAC detection.","title":"MAC aging"},{"location":"ccna/#mac-address-conversion","text":"Character HEX a 10 b 11 c 12 d 13 e 14 f 15 One digit hex ---> 0-9 or A-F Two digit hex ---> Left to Right, units of 16 ---> units of 1. Hexadecimal A7 to decimal A = 10 units of 16 (A=16) ---> 160 7 = 7 units of 1 ---> 7 160 + 7 = 167 Decimal 241 to Hexadecimal 1. f = 15 * 16 2. 1 = 1 * 1 3. F1","title":"MAC address conversion"},{"location":"ccna/#violation-option","text":"protect - Drops traffic, no SYSLOG, no SNMP Trap, no counters increased restrict - Drops traffic, generate SNMP trap, generate SYSLOG. shutdown - Default, increase violation counters, Port shutdown in error-disabled. Show port-security commands show port - security interface fastethernet 0 / 1 show port - security address Error disabled recovery Default recovery 300 seconds conf t errordisable recovery cause ? errordisable recovery cause psecure - violation errdisable recovery interval 30 show errdisable recovery","title":"Violation option"},{"location":"ccna/#vlan-interfaces-svi","text":"Layer 2 vlan must exist Physical interface with vlan attached to must be in UP and UP. Can be a trunk with vlan allowed or an access port with the vlan.","title":"VLAN interfaces (SVI)"},{"location":"ccna/#autonegociation-speed-and-duplex","text":"Highest speed supported by both is used. Full duplex supported by both is used. DO NOT set one side auto and the other side forced. Symptoms --> Slow Upload, irregular speed, packet loss, CRC/Runt frames errors on the interface","title":"Autonegociation - Speed and Duplex"},{"location":"ccna/#interface-range","text":"interface range fastethernet 0 / 1 - 24 interface range fastethernet 0 / 1 - 24 , 25 , 26","title":"Interface range"},{"location":"ccna/#tcp-and-udp","text":"","title":"TCP and UDP"},{"location":"ccna/#tcp","text":"Guarantees delivery of segments Error Detection and recovery Sequence numbers and ACK to recover from lost/corrupt packets TCP Windowing Connection-oriented Three-way handshake SYN FLAG / ACK FLAG Source ---> Destination : SYN Destination ---> Source : SYN-ACK Source ---> Destination : ACK Connection Established When connection is terminated - 4 Way Handshake Client ---> Server : FIN, ACK Client <--- Server : ACK Client <--- Server : ACK, FIN Client ---> Server : ACK Flow control and Windowing The receiver increases the Window size / controls the flow. The receiver asks for more data when traffic flows well --> No errors/retransmits on packets.","title":"TCP"},{"location":"ccna/#udp","text":"\"Best Effort\" No Error Detection No Windowing Connectionless - Data is sent without the remote peer being aware.","title":"UDP"},{"location":"ccna/#port-numbers","text":"Well-known port numbers: Protocol / Transport Port HTTPS / TCP 443 SNMP / UDP 161 SMTP / TCP 25 TELNET / TCP 22 SSH / TCP 23 Socket ---> Combination of an ipaddress and a port number. 192.168.1.1:10000","title":"Port Numbers"},{"location":"ccna/#dhcp","text":"DORA 1. Discover - Broadcast from client. 2. Offer - DHCP server receives Discover and sends unicast offer to client. 3. Request - Client sends request for the offered IP address. 4. Ack - DHCP server ack the client request and assigns the IP.","title":"DHCP"},{"location":"ccna/#routing-static-routes","text":"ip route destination_subnet destination_mask [ local - router - exit - interface | next - hop - ip - address ] ip route 2 . 2 . 2 . 2 255 . 255 . 255 . 0 192 . 168 . 1 . 1 # Default Route ip route 0 . 0 . 0 . 0 0 . 0 . 0 . 0 [ local - router - exit - interface | next - hop - ip - address ]","title":"Routing - Static Routes"},{"location":"ccna/#routing-distance-vector-protocols-rip","text":"RIPv1 / IGRP Full route table update at fixed interval. Every 30 seconds for RIP. Do not subnet VLSM. No Packet authentication. RIPv2 Supports VLSM. Multicasts from router updates - 224.0.0.9 instead of broadcast (RIPv1) Supports Authentication. Supports route summarization. Split Horizon A route cannot be advertised via an interface that received the route in the first place. No split horizon on frame-relay. Route Poisoning When all routers have the same routing table --> State of convergence Slow to converge When router removes a subnet that is local to itself. Send update that shows 16 hops for the removed subnet. Other routers will receive the update and remove the route from their own routing tables as 16 hops marks a subnet as unreachable. Hops Metric for RIPv2. Measures of distance to reach a specific subnet. Does not care about interface speed - only hop count.","title":"Routing - Distance Vector Protocols - RIP"},{"location":"ccna/#enabling-ripv2","text":"conf t router rip # Show protocols active on router show ip protocols # Enable specific version of RIPv2 per interface or global . interface gig0 / 1 ip rip send version 2 conf t router rip rip version 2 network 10 . 10 . 10 . 0 network 10 . 10 . 11 . 0 # Disable auto summary conf t router rip no auto - summary # Enable split Horizon interface serial0 / 1 / 0 ip split - horizon Confirming that RIPV2 works. show ip protocols show ip rip database Clear RIP routes. clear ip route *","title":"Enabling RIPv2"},{"location":"ccna/#passive-interfaces","text":"Prevents sending RIPv2 updates from interfaces where it's not necessary. conf t router rip passive - interface fastethernet0 / 1 passive - interface fastethernet0 / 2 conf t router rip passive - interface default no passive - interface fastethernet0 / 1 no passive - interface fastethernet0 / 2","title":"Passive interfaces"},{"location":"ccna/#rip-load-balancing","text":"1) If a subnet is reachable through two paths with the same hope count --> Load balance across the two links. Disabling equal cost load balancing conf t router rip maximum - path 1","title":"RIP Load Balancing"},{"location":"ccna/#default-route-in-rip","text":"conf t router rip default - information originate","title":"Default route in RIP"},{"location":"ccna/#routing-administrative-distance","text":"1) The prefix mask is considered first. The more specific route is installed. 2) If the prefix max is \"=\" ---> Administrative Distance is checked. The route with the lowest ADs wins.","title":"Routing Administrative distance"},{"location":"ccna/#floating-static-routes","text":"If a route with a lower AD is removed from the routing table, the static route will be added and become active. conf t ip route 2 . 2 . 2 . 0 255 . 255 . 255 . 0 21 . 1 . 1 . 2 [ static route metric here | higher than routing protocol 1 - 255 ]","title":"Floating static routes"},{"location":"ccna/#subnetting","text":"128 64 32 16 8 4 2 1 45 0 0 0 0 1 1 0 1 200.17.100.3 128 64 32 16 8 4 2 1 200 1 1 0 0 1 0 0 0 17 0 0 0 1 0 0 0 1 100 0 1 1 0 0 1 0 0 3 0 0 0 0 0 0 1 1 11001000.00010001.01100100.00000011","title":"Subnetting"},{"location":"ccna/#network-class","text":"Class A Class B Class C 1st Octet range 1 - 126 128 - 191 192 - 223 Network Mask 255.0.0.0 - /8 255.255.0.0 - /16 255.255.255.0 - /24","title":"Network class"},{"location":"ccna/#number-of-subnet-in-a-network-200110-27","text":"Find the class of the subnet --> Class C (+192) A class C is a /24 by default. /27 - /24 = 3 subnet bits. Number of subnet --> 2^Number_subnet_bits_remaining --> 2^3 --> 2 * 2 * 2 = 8 subnets","title":"Number of subnet in a network - 200.1.1.0 /27"},{"location":"ccna/#number-of-hosts-per-subnet-200110-27","text":"Find the number of host bits --> /32 - /27 --> /5 host bits Find the number of valid host per subnet - remove subnet and broadcast address. (2^(number of host bits))-2 --> 2^5 --> 2 * 2 * 2 * 2 * 2 --> 32 - 2 --> 30","title":"Number of hosts per subnet - 200.1.1.0 /27"},{"location":"ccna/#find-the-subnet-of-an-ip-address-101721418","text":"/18 = First two octets = 16 bits + 2 bits from third octet 10.17.00000010 10.17. 00 000000 --> Total of 18 bits for subnet address Subnet address = 10.17.0.0/18","title":"Find the Subnet of an IP address - 10.17.2.14/18"},{"location":"ccna/#find-the-broadcast-and-range-of-valid-addresses-in-subnet-210461100-25","text":"/32 - /25 = last 7 bits --> host bits 01111111 --> 64 + 32 +16 +8 + 4 + 2 +1 --> 96 + 16 + 15 --> 96 + 31 --> Broadcast = 210.46.110.127","title":"Find the broadcast and range of valid addresses in subnet - 210.46.110.0 /25"},{"location":"ccna/#find-the-broadcast-and-range-of-valid-addresses-in-subnet-15010640-18","text":"/32 - /18 = last 14 bits --> host bits 128 64 32 16 8 4 2 1 64 0 1 0 0 0 0 0 0 Broadcast --> 150.10.0 1111111.11111111 --> 150.10.127.255 Range of valid addresses --> 150.10.64.1 to 150.10.127.254","title":"Find the broadcast and range of valid addresses in subnet - 150.10.64.0 /18"},{"location":"ccna/#access-lists","text":"All ACL have an implicit DENY ALL ALL at the end. The search is done TOP to BOTTOM When a match is found, that's the end of the search. Any remaining lines are not examined.","title":"Access Lists"},{"location":"ccna/#wildcard-masks","text":"0 --> All bits must match. 1 --> Does not need to match.","title":"Wildcard masks"},{"location":"ccna/#standard-acl","text":"Can only match on the SOURCE ip address of a packet. Standard Access list number : 1 --> 99 Standard expanded access list number : 1300 --> 1999 < 1 - 99 > Standard IP access - list number < 1300 - 1999 > Standard IP access - list number ( expanded range ) WORD Access - list name ip access - list standard 5 deny 3 . 3 . 3 . 0 0 . 0 . 0 . 255 interface fastethernet0 ip access - group 5 in","title":"Standard ACL"},{"location":"ccna/#extended-acl","text":"Can match on source AND/OR destination.","title":"Extended ACL"},{"location":"ccna/#named-extendedstandard-acl","text":"Allows naming of Access list instead of number. Valid for Standard and Extended ACL. Cannot have an Extended and Standard ACL with the same name. You need to use ip access-list standard | extended instead of access-list conf t ip access - list extended BLOCK11 deny ip 3 . 3 . 3 . 0 0 . 0 . 0 . 255 11 . 11 . 11 . 0 0 . 0 . 0 . 255 permet ip any any","title":"Named Extended/Standard ACL"},{"location":"ccna/#acl-on-vty-lines","text":"conf t line vty 0 14 access - class MGMT - NETWORKS in","title":"ACL on VTY lines"},{"location":"ccna/#acl-sequence-numbers","text":"Allows moving and deletion of specific lines within the ACL. You cannot move or reassign a sequence number. You need to delete and recreate the line with the new sequence number. conf t ip access - list extended 101 no $ SEQUENCE_NUMVER","title":"ACL Sequence numbers"},{"location":"ccna/#where-to-apply-acls","text":"Apply Extended ACLs as close to the source of the traffic. Apply Standard ACL as close to the destination as possible.","title":"Where to apply ACLs"},{"location":"ccna/#ntp-network-time-protocol","text":"Creates a single source of time for all device on the network. UDP Port 123","title":"NTP - Network Time Protocol"},{"location":"ccna/#stratum-level-of-accuracy-of-the-ntp-server","text":"0 --> Atomic clocks 1 --> Gets time from a stratum 0 NTP server.","title":"Stratum - Level of accuracy of the NTP server."},{"location":"ccna/#ntp-modes","text":"Master : Set the device itself as the master and will synch with itself to synchronize time. Peer : The two devices will dynamically synchronize time between the two. Server : The client device will ask time from the server. Does not send time synchronize requests to the server. Broadcast Mode : Broadcast mode for NTP packets. !*** Set the device itself as the master NTP server . conf t ntp master !*** Set the NTP server for the device . conf t ntp server ntp . nist . ca conf t ntp peer ntp . potato . com !*** Show all ntp services from which the device will sync it ' s clock. Also shows the preferred device. show ntp associations show ntp status show clock !*** Under device interface configuration . !*** Sets broadcast server mode ( send updates ) conf t interface serial 0 / 1 / 0 ntp broadcast !*** Set client broadcast mode conf t interface serial 0 / 1 / 0 ntp broadcast client","title":"NTP Modes"},{"location":"ccna/#nat-pat-network-address-translation-port-address-translation","text":"Local --> Private address Global --> Public routable address Inside Local --> Local Address being translated to External. Inside Global --> External Address that is used during the NAT. Outside Local --> Non-routable addresses of the host on the remote network. Outside Global --> Routable addresses of the host on the remote network.","title":"NAT / PAT - Network Address Translation / Port Address Translation"},{"location":"ccna/#static-nat","text":"One to one mapping of an Inside Local to a Inside Global. I.E : Map a public IP to the internal IP of a server. !*** Place on the interfaces closest to the hosts . ip nat inside !*** Place on the WAN interface . ip nat outside !*** Setup Static NAT / One to one mapping ip nat inside source static 10 . 1 . 1 . 2 200 . 1 . 1 . 1 !*** Show translations show ip nat translations !*** Show NAT statistics show ip nat statistics !*** clear ip nat table to reset the NAT mappings clear ip nat translations *","title":"Static NAT"},{"location":"ccna/#dynamic-nat","text":"Allow the NAT of a pool of internal address to a pool of outside addresses. !*** Create IP NAT Pool ip nat pool CCNA 200 . 1 . 1 . 1 200 . 1 . 1 . 5 prefix - length 24 !*** Create the access - list of internal host that will be NAT . access - list 2 permit host 10 . 1 . 1 . 2 access - list 2 permit host 10 . 1 . 1 . 22 !*** Create the NAT function for the access - list 2 and the pool CCNA ip nat inside source list 2 pool CCNA","title":"Dynamic NAT"},{"location":"ccna/#port-address-translation-nat-overload","text":"Allows the mapping of multiple inside addresses to a single outside address using a combination of the IP address / Port Number in ordre to uniquely identify each flow of data. !*** Overload of the inside addresses to the outside address ip nat inside source list 2 interface serial0 / 1 / 0 overload","title":"Port address translation - NAT Overload"},{"location":"ccna/#ipv6","text":"Solution to the IPv4 exhaustion. 128 bit addresses 8 blocks of 4 HEX characters. No more broadcast - only multicasts. Easier summarization. Can be run without a DHCP server. IANA (Internet Assigned Numbers Authority) - Assigns IP blocks to RIR (Regional Internet Registry - ARIN, RIPE, AFRINIC, APNIC, LACNIC.","title":"IPv6"},{"location":"ccna/#compressing-ipv6-addresses","text":"Compress consecutive blocks of 0000 with :: Can only do once per IPv6 addresses Remove leading 0 in blocks.","title":"Compressing IPv6 addresses"},{"location":"ccna/#assigning-ipv6-addresses-to-interfaces","text":"! ### Enable IPv6 Routing for the router . ipv6 unicast - routing ! ### Assign an IPv6 address to an interface interface fastethernet0 / 1 ipv6 address 2001 : 1111 : 2222 : 1 :: 1 / 64","title":"Assigning IPv6 addresses to interfaces"},{"location":"ccna/#types-of-ipv6-addresses","text":"There is no broadcast - only Unicast and Multicast. Global Unicast addresses Routable public addresses Link-local addresses : Addresses used in links directly. Routers will not route those packets. Addresses will always start FE80:0000:0000:0000 (FE80:/10) 64-bit interface identifier - EUI-64 process","title":"Types of IPv6 addresses."},{"location":"ccna/#eui-64-process","text":"Take MAC address of the interface 11-22-33-aa-bb-cc Divide in half and insert FFFE. 11-22-33-FF-FE-AA-BB-CC 1122:33FF:FEAA:BBCC Do the bit inversion (invert the 7th bit of the address) 1122:33FF:FEAA:BBCC --> 1322:33FF:FEAA:BBCC","title":"EUI-64 Process"},{"location":"ccna/#use-eui-64-process-for-global-unicast-address","text":"ipv6 address 2001 : 1111 : 2222 : 1 :: / 64 eui - 64","title":"Use EUI-64 process for global unicast address."},{"location":"ccna/#ipv6-ndp-neighbor-discovery-process","text":"Allows IPv6 enabled device to discover hosts and routers on an IPv6 enabled network. The discovery process is different for routers and hosts.","title":"IPv6 NDP - Neighbor Discovery Process"},{"location":"ccna/#ndp-router-discovery","text":"Hosts multicast packet - Router Solicitation (RS) message - Destination address FF02::2 - All-IPv6-Routers address Routers receives RS on FF02::2 and sends RA (Router Advertisement). If the soliciting node HAS an IPv6 address --> RA is unicast to the host. If the soliciting node DOES NOT have an IPv6 address --> RA is sent to FF02::1 - \"All-IPV6-Nodes\" RA are also sent to FF02::1 every 200 seconds. FF02::1 --> All IPv6 hosts.","title":"NDP - Router Discovery"},{"location":"ccna/#ndp-host-discovery","text":"NS --> Neighbor Solicitation. NA --> Neighbor Advertisement. NA is sent to SNMA - Solicited-node multicast address. Always begin with FF02::1:FF Contains the last 6 HEX characters of the interface mac address. That way only the relevant hosts will receive the requested NA. Host that receives the NA, add the entry to the NDP table - same purpose as the ARP table.","title":"NDP - Host Discovery"},{"location":"ccna/#dhcp-and-ipv6","text":"Same basic functionality as IPv4 but two different types of DHCPv6 servers : Stateful and Stateless.","title":"DHCP and IPv6"},{"location":"ccna/#stateful-dhcp","text":"SARR (instead of DORA) Solicit - Client Advertise - Server offers the address to the Client Request - Client request the previously offered lease to the server Reply - The Server confirms the lease to the client Stateful DHCP does not send \"Default Gateway\" in the DHCP lease. That part is discovered during the NDP process with NA and NS messages.","title":"Stateful DHCP"},{"location":"ccna/#stateless-dhcp","text":"Stateless autoconfiguration - SLAAC. Hosts will generate their own ip addresses from information received during the RA - RS process. RA messages will contain the subnet prefix and the prefix length. The host will then create it's own IP address adding it's own interface identifier at the end.","title":"Stateless DHCP"},{"location":"ccna/#ipv6-duplicate-address-detection-dad","text":"Prevents duplicate addresses from being used on the network. 1. The host will send an NS (with the source address all :: - 128 zeros - unspecified ipv6 address) to the address it wants to use to FF02::1 (All IPV6 nodes) 2. If it gets a response, it means that a host is already using that address.","title":"IPv6 - Duplicate Address Detection - DAD"},{"location":"ccna/#ipv6-packet-header","text":"Version : Set to 6 Traffic class : Replaces \"Type of Service\". Allow level of importance with QOS. Flow Label: NEW FIELD - Allow traffic priorities and categorization. Works with QOS and Traffic Class. Payload Length: Total length of packet Hop Limit : Like the TTL field of IPv4. Each hope decreases the counter by 1. Next Header : Equivalent to the Protocol field. Source Address : Source Address of the packet Destination Address : Destination Address of the packet","title":"IPv6 Packet Header"},{"location":"ccna/#logging-and-timestamps","text":"Change the aspect and format of timestamps for SYSLOG and DEBUG message. service timestamps log datetime ! ### Add year to log timestamps . service timestamps log datetime year ! ### Add millisecond to log timestamps . service timestamps log datetime msec service timestamps log datetime year msec show - timezone","title":"Logging and Timestamps"},{"location":"ccna/#logging-to-remote-server","text":"Enable logging to the console. logging console Enable buffered logging. Local buffer on the server. logging buffer Enable logging to a remote server. logging host $ SYSLOG_SERVER_IPADDRESS Enable console logging on SSH/Telnet session conf t logging monitor exit terminal monitor","title":"Logging to remote server"},{"location":"ccna/#banner-configuration","text":"Three types of banners. Login : Shown during the login prompt. Telnet and SSH. Exec : Shown after the user logs in. Telnet and SSH. MOTD : Shown along the login prompt. SSHv2 --> SHOWN AFTER LOGIN INTO THE DEVICE WITH EXEC BANNER.","title":"Banner configuration"},{"location":"ccna/#cdp-cisco-discovery-protocol","text":"Default timers Hold Timer - 180 seconds - After 180 seconds, the entry is removed. Advertisement timer - 60 seconds. show cdp neighbors show cdp neighbors details show cdp entry $ REMOTE_DEVICE_HOSTNAME !*** Enable CDP globally . cdp run no cdp run !*** Enable CDP on an interface interface fastethernet0 / 0 cdp enable no cdp enable !*** Show CDP information show cdp information show cdp interface fastethernet 0 / 0","title":"CDP - Cisco Discovery Protocol"},{"location":"ccna/#lldp-link-layer-discovery-protocols","text":"You can disable the received and transmit of LLDP packets per interface. That is not possible for CDP. show lldp conf t lldp run show lldp neighbor detail","title":"LLDP - Link Layer Discovery Protocols"},{"location":"ccna/#confreg-register-and-password-recovery","text":"RONMON mode --> Allow to boot IOS without reading the NVRAM router config. show version | include register config - register 0 x2142","title":"Confreg Register and Password Recovery"},{"location":"chef/","text":"Chef server setup sudo dpkg - i / tmp / chef - server - core -< version > . deb chef - server - ctl reconfigure chef - server - ctl user - create USER_NAME FIRST_NAME LAST_NAME EMAIL 'PASSWORD' --filename FILE_NAME chef - server - ctl org - create northernsysadmin 'Northern Sysadmin Inc' --association_user sysadmin --filename /var/chef_ssh/northernsysadmin-validator.pem knife ssl check knife ssl fetch knife cookbook upload $ COOKBOOK_NAME_HERE knife client list knife cookbook list knife bootstrap 10.255.255.8 --ssh-user sysadmin --ssh-password 'PASSWORD_HERE' --sudo --use-sudo-password --node-name puppet-minion1 --run-list 'recipe[learn_chef_apache2]' knife node list knife node show $ NODE_NAME Create roles and assign cookbooks to them. roles/ntp.json { \"name\" : \"ntp\" , \"description\" : \"NTP server role.\" , \"json_class\" : \"Chef::Role\" , \"default_attributes\" : { \"chef_client\" : { \"interval\" : 60 , \"splay\" : 1 } }, \"override_attributes\" : { }, \"chef_type\" : \"role\" , \"run_list\" : [ \"recipe[chef-client::default]\" , \"recipe[chef-client::delete_validation]\" , \"recipe[ntpd::default]\" ], \"env_run_lists\" : { } } Upload the role to the Chef Server : knife role from file roles/web.json Check that the role is on the server : knife role list - knife role show ntp Find node name from knife node list - knife node run_list set puppet-minion1 \"role[ntp]\" Confirm that the role is applied to the Node : knife node show puppet-minion1 --run-list Run chef-client on the node. knife ssh 10.255.255.8 'role:web' 'sudo chef-client' --ssh-user sysadmin --ssh-password 'PASSWORD_HERE' --sudo --use-sudo-password --node-name puppet-minion1 Dependencies in cookbooks. metadata.rb - keyword \"depends\" - Used to list the other coobooks from which the cookbook depends to run properly. name 'prometheus_node' maintainer 'Laurent Dumont' maintainer_email 'ldumont@northernsysadmin.com' license 'All Rights Reserved' description 'Installs/Configures prometheus-node' long_description 'Installs/Configures prometheus-node' version '0.1.1' depends 'tar' chef_version '>= 12.14' if respond_to? ( :chef_version )","title":"Chef"},{"location":"chef/#chef-server-setup","text":"sudo dpkg - i / tmp / chef - server - core -< version > . deb chef - server - ctl reconfigure chef - server - ctl user - create USER_NAME FIRST_NAME LAST_NAME EMAIL 'PASSWORD' --filename FILE_NAME chef - server - ctl org - create northernsysadmin 'Northern Sysadmin Inc' --association_user sysadmin --filename /var/chef_ssh/northernsysadmin-validator.pem knife ssl check knife ssl fetch knife cookbook upload $ COOKBOOK_NAME_HERE knife client list knife cookbook list knife bootstrap 10.255.255.8 --ssh-user sysadmin --ssh-password 'PASSWORD_HERE' --sudo --use-sudo-password --node-name puppet-minion1 --run-list 'recipe[learn_chef_apache2]' knife node list knife node show $ NODE_NAME","title":"Chef server setup"},{"location":"chef/#create-roles-and-assign-cookbooks-to-them","text":"roles/ntp.json { \"name\" : \"ntp\" , \"description\" : \"NTP server role.\" , \"json_class\" : \"Chef::Role\" , \"default_attributes\" : { \"chef_client\" : { \"interval\" : 60 , \"splay\" : 1 } }, \"override_attributes\" : { }, \"chef_type\" : \"role\" , \"run_list\" : [ \"recipe[chef-client::default]\" , \"recipe[chef-client::delete_validation]\" , \"recipe[ntpd::default]\" ], \"env_run_lists\" : { } } Upload the role to the Chef Server : knife role from file roles/web.json Check that the role is on the server : knife role list - knife role show ntp Find node name from knife node list - knife node run_list set puppet-minion1 \"role[ntp]\" Confirm that the role is applied to the Node : knife node show puppet-minion1 --run-list Run chef-client on the node. knife ssh 10.255.255.8 'role:web' 'sudo chef-client' --ssh-user sysadmin --ssh-password 'PASSWORD_HERE' --sudo --use-sudo-password --node-name puppet-minion1","title":"Create roles and assign cookbooks to them."},{"location":"chef/#dependencies-in-cookbooks","text":"metadata.rb - keyword \"depends\" - Used to list the other coobooks from which the cookbook depends to run properly. name 'prometheus_node' maintainer 'Laurent Dumont' maintainer_email 'ldumont@northernsysadmin.com' license 'All Rights Reserved' description 'Installs/Configures prometheus-node' long_description 'Installs/Configures prometheus-node' version '0.1.1' depends 'tar' chef_version '>= 12.14' if respond_to? ( :chef_version )","title":"Dependencies in cookbooks."},{"location":"cisco/","text":"General Troubleshooting IOS-XR !Check Policy-Map drops/number of packet matching the policy. show policy - map interface $ PHYSICAL_INTERFACE service instance $ SVC_INST_ID !Show l2vpn xconnect status (ASR 9k) show l2vpn service xconnect interface gigabitEthernet 0 / 1 !Show l2vpn xconnect status with details (ASR 9k) show l2vpn xconnect neighbor 192 . 252 . 143 . 75 pw - id 702 detail !Show service-instance traffic details (not xconnect, just local service instance) show ethernet service instance id 205 int ten0 / 3 / 0 detail show mpls l2transport vc vcid 395 detail !ASR 9000 | IOS-XE show l2vpn service xconnect interface TenGigabitEthernet0 / 3 / 0 show l2vpn xconnect group OPEN01 xc - name OPEN01 - C220 show l2vpn xconnect group PARA07 detail !BGP stuff | IOS-XE show bgp summary | inc NEIGHBOR_IP !BGP stuff | IOS-XR show ip bgp summary show ip bgp neighbors show ip bgp neighbors 1 . 1 . 1 . 1 !Montrer les routes recu d'un neighbor en particulier conf t router bgp AS_NUMBER !Il faut activer le log des routes pour chacun des neighbors BGP concern\u00e9s neighbor 1 . 1 . 1 . 1 soft - reconfiguration inbound exit sh ip bgp neighbors 1 . 1 . 1 . 1 received - routes sh ip bgp neighbors 1 . 1 . 1 . 1 advertised - routes conf t router bgp AS_NUMBER neighbor 1 . 1 . 1 . 1 shutdown !Satellite 9k light levels show nV satellite status telnet vrf ** nVSatellite 10 . 0 . 100 . 1 ! GigabitEthernet112 / 0 / 0 / 17 ---> Satellite 112 telnet vrf ** nVSatellite 10 . 0 . 112 . 1 ! Port 17 on ASR = Port 18 on Satellite sh satellite powerlevels port 18 https://www.cisco.com/c/en/us/td/docs/routers/access/4400/troubleshooting/memorytroubleshooting/isr4000_mem.html https://www.cisco.com/c/en/us/support/docs/routers/4000-series-integrated-services-routers/210760-Monitor-CPU-Usage-On-ISR4300-Series.html show process cpu sorted | ex 0 . 0 show platform hardware qfp active datapath utilization show platform software status control - processor show platform software status control - processor brief show processes cpu platform sorted show platform software status control - processor brief Show CPU and Memory like \"htop\" for Linux monitor platform software process rp active Troubleshooting Cisco ISR Memory. Show IOS processes memory usage. show processes memory Show platform CPU and Memory usage show platform resources Show IOS-XE Memory usage (not IOS) show platform software status control - processor brief Cisco Radius conf t aaa new - model aaa group server radius DHMTL - RADIUS server - private 10 . 0 . 99 . 22 auth - port 1812 acct - port 1813 key $ INSERT_KEY_HERE aaa group server tacacs + DHMTL - TACACS server - private 10 . 0 . 99 . 22 key $ INSERT_KEY_HERE aaa authentication login default group DHMTL - RADIUS local aaa authorization exec default group DHMTL - RADIUS local aaa accounting commands 15 default start - stop group DHMTL - TACACS aaa accounting commands 3 default start - stop group DHMTL - TACACS","title":"Cisco"},{"location":"cisco/#general-troubleshooting","text":"IOS-XR !Check Policy-Map drops/number of packet matching the policy. show policy - map interface $ PHYSICAL_INTERFACE service instance $ SVC_INST_ID !Show l2vpn xconnect status (ASR 9k) show l2vpn service xconnect interface gigabitEthernet 0 / 1 !Show l2vpn xconnect status with details (ASR 9k) show l2vpn xconnect neighbor 192 . 252 . 143 . 75 pw - id 702 detail !Show service-instance traffic details (not xconnect, just local service instance) show ethernet service instance id 205 int ten0 / 3 / 0 detail show mpls l2transport vc vcid 395 detail !ASR 9000 | IOS-XE show l2vpn service xconnect interface TenGigabitEthernet0 / 3 / 0 show l2vpn xconnect group OPEN01 xc - name OPEN01 - C220 show l2vpn xconnect group PARA07 detail !BGP stuff | IOS-XE show bgp summary | inc NEIGHBOR_IP !BGP stuff | IOS-XR show ip bgp summary show ip bgp neighbors show ip bgp neighbors 1 . 1 . 1 . 1 !Montrer les routes recu d'un neighbor en particulier conf t router bgp AS_NUMBER !Il faut activer le log des routes pour chacun des neighbors BGP concern\u00e9s neighbor 1 . 1 . 1 . 1 soft - reconfiguration inbound exit sh ip bgp neighbors 1 . 1 . 1 . 1 received - routes sh ip bgp neighbors 1 . 1 . 1 . 1 advertised - routes conf t router bgp AS_NUMBER neighbor 1 . 1 . 1 . 1 shutdown !Satellite 9k light levels show nV satellite status telnet vrf ** nVSatellite 10 . 0 . 100 . 1 ! GigabitEthernet112 / 0 / 0 / 17 ---> Satellite 112 telnet vrf ** nVSatellite 10 . 0 . 112 . 1 ! Port 17 on ASR = Port 18 on Satellite sh satellite powerlevels port 18 https://www.cisco.com/c/en/us/td/docs/routers/access/4400/troubleshooting/memorytroubleshooting/isr4000_mem.html https://www.cisco.com/c/en/us/support/docs/routers/4000-series-integrated-services-routers/210760-Monitor-CPU-Usage-On-ISR4300-Series.html show process cpu sorted | ex 0 . 0 show platform hardware qfp active datapath utilization show platform software status control - processor show platform software status control - processor brief show processes cpu platform sorted show platform software status control - processor brief Show CPU and Memory like \"htop\" for Linux monitor platform software process rp active","title":"General Troubleshooting"},{"location":"cisco/#troubleshooting-cisco-isr-memory","text":"Show IOS processes memory usage. show processes memory Show platform CPU and Memory usage show platform resources Show IOS-XE Memory usage (not IOS) show platform software status control - processor brief","title":"Troubleshooting Cisco ISR Memory."},{"location":"cisco/#cisco-radius","text":"conf t aaa new - model aaa group server radius DHMTL - RADIUS server - private 10 . 0 . 99 . 22 auth - port 1812 acct - port 1813 key $ INSERT_KEY_HERE aaa group server tacacs + DHMTL - TACACS server - private 10 . 0 . 99 . 22 key $ INSERT_KEY_HERE aaa authentication login default group DHMTL - RADIUS local aaa authorization exec default group DHMTL - RADIUS local aaa accounting commands 15 default start - stop group DHMTL - TACACS aaa accounting commands 3 default start - stop group DHMTL - TACACS","title":"Cisco Radius"},{"location":"docker/","text":"Docker install bash script. # Install docker #!/ bin / bash sudo apt - get install \\ apt - transport - https \\ ca - certificates \\ curl \\ gnupg2 \\ software - properties - common curl - fsSL https : // download . docker . com / linux / debian / gpg | sudo apt - key add - sudo add - apt - repository \\ \"deb [arch=amd64] https://download.docker.com/linux/debian \\ $(lsb_release -cs) \\ stable\" sudo apt - get update && apt - get install docker - ce IDRAC Docker VNC image https://github.com/DomiStyle/docker-idrac6 docker run - d - p 5800 : 5800 - p 5900 : 5900 - e IDRAC_HOST = IP_HERE - e IDRAC_USER = root - e IDRAC_PASSWORD = calvin domistyle / idrac6 Radarr Docker docker volume create radarr - config sudo docker run \\ - d \\ --name=radarr \\ - e PUID = 109 \\ - e PGID = 113 \\ - e TZ = America / Toronto \\ - p 7878 : 7878 \\ - v radarr - config : / config \\ - v / storage / media - gluster / movies / : / movies \\ - v / storage / media - gluster / downloads : / downloads \\ --restart unless-stopped \\ linuxserver / radarr Grafana Docker sudo docker volume create grafana - storage docker run \\ - d \\ - p 3000 : 3000 \\ --name=grafana \\ - v grafana - storage : / var / lib / grafana \\ grafana / grafana Couchpotato Docker. docker volume create couchpotato - config docker run \\ --name=couchpotato \\ - v couchpotato - config : / config \\ - v / storage / torrents_download : / downloads \\ - v / storage / media / movies : / movies \\ - e TZ = America / Toronto \\ - e PGID = 113 - e PUID = 109 \\ - p 5050 : 5050 \\ - d \\ linuxserver / couchpotato Watch docker stats watch 'docker stats --no-stream --format \"table {{ .Container }} \\t {{ .Name }} \\t {{ .CPUPerc }} \\t {{ .MemUsage }} \"'","title":"Docker"},{"location":"docker/#docker-install-bash-script","text":"# Install docker #!/ bin / bash sudo apt - get install \\ apt - transport - https \\ ca - certificates \\ curl \\ gnupg2 \\ software - properties - common curl - fsSL https : // download . docker . com / linux / debian / gpg | sudo apt - key add - sudo add - apt - repository \\ \"deb [arch=amd64] https://download.docker.com/linux/debian \\ $(lsb_release -cs) \\ stable\" sudo apt - get update && apt - get install docker - ce","title":"Docker install bash script."},{"location":"docker/#idrac-docker-vnc-image","text":"https://github.com/DomiStyle/docker-idrac6 docker run - d - p 5800 : 5800 - p 5900 : 5900 - e IDRAC_HOST = IP_HERE - e IDRAC_USER = root - e IDRAC_PASSWORD = calvin domistyle / idrac6","title":"IDRAC Docker VNC image"},{"location":"docker/#radarr-docker","text":"docker volume create radarr - config sudo docker run \\ - d \\ --name=radarr \\ - e PUID = 109 \\ - e PGID = 113 \\ - e TZ = America / Toronto \\ - p 7878 : 7878 \\ - v radarr - config : / config \\ - v / storage / media - gluster / movies / : / movies \\ - v / storage / media - gluster / downloads : / downloads \\ --restart unless-stopped \\ linuxserver / radarr","title":"Radarr Docker"},{"location":"docker/#grafana-docker","text":"sudo docker volume create grafana - storage docker run \\ - d \\ - p 3000 : 3000 \\ --name=grafana \\ - v grafana - storage : / var / lib / grafana \\ grafana / grafana","title":"Grafana Docker"},{"location":"docker/#couchpotato-docker","text":"docker volume create couchpotato - config docker run \\ --name=couchpotato \\ - v couchpotato - config : / config \\ - v / storage / torrents_download : / downloads \\ - v / storage / media / movies : / movies \\ - e TZ = America / Toronto \\ - e PGID = 113 - e PUID = 109 \\ - p 5050 : 5050 \\ - d \\ linuxserver / couchpotato","title":"Couchpotato Docker."},{"location":"docker/#watch-docker-stats","text":"watch 'docker stats --no-stream --format \"table {{ .Container }} \\t {{ .Name }} \\t {{ .CPUPerc }} \\t {{ .MemUsage }} \"'","title":"Watch docker stats"},{"location":"foreman/","text":"Update Foreman # https : // theforeman . org / manuals / 1 . 22 / index . html # 3 . 6 Upgrade systemctl apache2 stop # Upgrade . list file from / etc / apt / sources . list . d / foreman . list apt - get update apt - get --only-upgrade install ruby\\* foreman\\* foreman - rake db : migrate foreman - rake db : seed foreman - rake tmp : cache : clear foreman - rake db : sessions : clear # Test Foreman upgrade foreman - installer --noop --dont-save-answers --verbose # Start Foreman installer upgrade . foreman - installer service apache2 restart Fix failing GEM packages. # As root su foreman # cd to home cd mv Gemfile.lock Gemfile.lock.backup /usr/bin/foreman-ruby /usr/bin/bundle update /usr/bin/foreman-ruby /usr/bin/bundle install Remove plugin # Remove the gem file for your plugin. # rm ~foreman/bundler.d/Gemfile.local.rb # ~Gemfile.local.rb # Reinstall all gems without the old one /usr/bin/foreman-ruby /usr/bin/bundle install # Restart Foreman touch ~foreman/tmp/restart.txt","title":"Foreman"},{"location":"foreman/#update-foreman","text":"# https : // theforeman . org / manuals / 1 . 22 / index . html # 3 . 6 Upgrade systemctl apache2 stop # Upgrade . list file from / etc / apt / sources . list . d / foreman . list apt - get update apt - get --only-upgrade install ruby\\* foreman\\* foreman - rake db : migrate foreman - rake db : seed foreman - rake tmp : cache : clear foreman - rake db : sessions : clear # Test Foreman upgrade foreman - installer --noop --dont-save-answers --verbose # Start Foreman installer upgrade . foreman - installer service apache2 restart","title":"Update Foreman"},{"location":"foreman/#fix-failing-gem-packages","text":"# As root su foreman # cd to home cd mv Gemfile.lock Gemfile.lock.backup /usr/bin/foreman-ruby /usr/bin/bundle update /usr/bin/foreman-ruby /usr/bin/bundle install","title":"Fix failing GEM packages."},{"location":"foreman/#remove-plugin","text":"# Remove the gem file for your plugin. # rm ~foreman/bundler.d/Gemfile.local.rb # ~Gemfile.local.rb # Reinstall all gems without the old one /usr/bin/foreman-ruby /usr/bin/bundle install # Restart Foreman touch ~foreman/tmp/restart.txt","title":"Remove plugin"},{"location":"git/","text":"Git Stuff easy-git.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/bash DIRECTORY = .git if [ -z \" $1 \" ] ; then echo \"You savage, you need a comment for a commit!\" exit fi if [ -d \" $DIRECTORY \" ] ; then git add . git commit -S -m \" $1 \" git push origin master else echo \"This is NOT a git repo\" fi Credentials git config --global credential.helper store git config --global credential.helper 'cache --timeout=3600'","title":"Git"},{"location":"git/#git-stuff","text":"","title":"Git Stuff"},{"location":"git/#easy-gitsh","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/bin/bash DIRECTORY = .git if [ -z \" $1 \" ] ; then echo \"You savage, you need a comment for a commit!\" exit fi if [ -d \" $DIRECTORY \" ] ; then git add . git commit -S -m \" $1 \" git push origin master else echo \"This is NOT a git repo\" fi","title":"easy-git.sh"},{"location":"git/#credentials","text":"git config --global credential.helper store git config --global credential.helper 'cache --timeout=3600'","title":"Credentials"},{"location":"gluster/","text":"sudo gluster peer probe kube2 sudo gluster peer status sudo gluster volume create gluster - vol - 1 replica 2 transport tcp kube1 : / gluster / gluster - vol - 1 kube2 : / gluster / gluster - vol - 1 No replicate - single server. gluster volume create $ VOLUME_NAME $ IPADDRESS_OR_DOMAINNAME : / $ ROOT_MOUNT_POINT / $ SUBFOLDER gluster volume start $ VOLUME_NAME Mount a gluster share. mount - t glusterfs $ GLUSTER_SERVER_IP : $ SHARE_NAME $ LOCAL_PATH sudo gluster volume start gluster - vol - 1","title":"Gluster"},{"location":"gluster/#no-replicate-single-server","text":"gluster volume create $ VOLUME_NAME $ IPADDRESS_OR_DOMAINNAME : / $ ROOT_MOUNT_POINT / $ SUBFOLDER gluster volume start $ VOLUME_NAME","title":"No replicate - single server."},{"location":"gluster/#mount-a-gluster-share","text":"mount - t glusterfs $ GLUSTER_SERVER_IP : $ SHARE_NAME $ LOCAL_PATH sudo gluster volume start gluster - vol - 1","title":"Mount a gluster share."},{"location":"iperf/","text":"UDP TEST (DDOS like test where you send traffic to the other endpoint without any policing. iPerf3 does not allow you to send traffic directly for UDP. It needs to \"connect\" to an iPerf3 endpoint, even for UDP. . / iperf - c TARGET_IP --udp --interval 2 --bandwidth 9m IPERF SERVER TCP . / iperf --server IPERF CLIENT TCP UPLOAD AND THEN DOWNLOAD . / iperf --client IPERF_SERVER --tradeoff --window 1M IPERF CLIENT TCP UPLOAD AND DOWNLOAD AT THE SAME TIME . / iperf --client IPERF_SERVER --dualtest --window 1M","title":"iPerf"},{"location":"juniper/","text":"Useful commands. # Show the current configuration . show configuration # Show the logs of the device . show log messsage # Show but compare show | compare # Show but display as a line configuration and not XML . show | display set # Show interface list and status show interfaces terse # Show current hardware show chassis hardware # Show global routing table show route show interface | incl ( proto | Desc ) # Show processus using memory and general system performance stats show system processes summary # Check CPU usage show chassis routing - engine show system process extensive | no - more Syslog configuration. set system syslog user * any emergency set system syslog host 10 . 0 . 99 . 28 any any set system syslog host 10 . 0 . 99 . 28 port 1514 set system syslog file messages any notice set system syslog file messages authorization info set system syslog file interactive - commands interactive - commands any Radius configuration. edit set system radius - server $ RADIUS_SERVER_IP_HERE source - address $ SWITCH_IP_HERE set system radius - server $ RADIUS_SERVER_IP_HERE secret $ PASSWORD_HERE set system authentication - order [ radius password ] #Create user profiles based on FreeIPA group. edit system login set user HELPDESK class read - only set user OPERATOR class super - user set user remote full - name \"default remote access user template\" set user remote class read - only Create a vlan set vlans OSTACK - TEST - 1 vlan - id 70 Create a L3 VLAN interface. set vlans MGMT vlan - id 69 set interfaces ge - 0 / 0 / 23 unit 0 family ethernet - switching port - mode trunk 666 vlan members 69 set interfaces vlan unit 69 family inet address 10 . 10 . 69 . 14 / 24 set vlans MGMT l3 - interface vlan . 69 Enable SSH with root login. set system services ssh root - login allow Create a default route. set routing - options static route 0 . 0 . 0 . 0 / 0 next - hop 10 . 10 . 69 . 1 Add a nameserver for DNS resolution. edit system name - server 8 . 8 . 8 . 8 Upgrade the JunOS image. request system software add http : // web . weba . ru / pub / 500 G_3 / Firmware / Juniper / 12 . 3 / domestic / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz file copy http : // web . weba . ru / pub / 500 G_3 / Firmware / Juniper / 12 . 3 / domestic / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz / var / tmp / request system software add / var / tmp / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz reboot Repair a JunOS partition that rebooted from the backup partition. *********************************************************************** ** ** ** WARNING : THIS DEVICE HAS BOOTED FROM THE BACKUP JUNOS IMAGE ** ** ** ** It is possible that the primary copy of JUNOS failed to boot up ** ** properly , and so this device has booted from the backup copy . ** ** ** ** Please re - install JUNOS to recover the primary copy in case ** ** it has been corrupted and if auto - snapshot feature is not ** ** enabled . ** ** ** *********************************************************************** show chassis alarms show system storage partitions request system snapshot media internal slice alternate show system snapshot media internal request system reboot slice alternate media internal Create an admin user. set system login user cmaker authentication plain - text - password set system login user cmaker class super - user Add a SSH key to a local user for password-less auth. set system login user prox - exporter - juniper authentication ssh - rsa \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDJZTRPs8WXsD1yNmWd69/zHNDf4ApvTXDjfk0rxEjgiDsOgWvID0Q8ZH0tFzSV9L0W7a/9jG0POuJyiGYF6M4X2QdEPSZ2CgxRm7GL4A1SJ4xbnCYny2k4L8C7UrDrvqThv6/FyyJopHCPp7S3j0iAI6c+Gtv59sbUvdilWC4Y5LX0ho+yocMaGvTOk+l5aQRU9eWmZsD0/3D0V99iBnm70rlEeEIr1Oe+M+y/Q/0vmBVdC75COCxu84PnLvqPH2yOf3j581wgIVncKbApB0b9ApTbCE94jNljtwM4uGM9qICOf0BwbrDfFT1L1n5ZQx7BZnD9410wv2jTYXTPUJV1\" set system login user prox - exporter - juniper class super - user Password recovery. Boot normally . Prompt : Hit [ Enter ] to boot immediately , or space bar for command prompt . press space during the boot process Type : loader > boot - s Type : Enter full pathname of shell or ' recovery ' for root password recovery or RETURN for / bin / sh : recovery Configure SNMP with contact and location strings. set snmp name \u201c cmaker - ex2200 \u201d description \u201c cmaker - ex2200 \u201d set snmp location \u201c 9880 Clark \u201d set snmp contact \"laurentfdumont@gmail.com\" set snmp community cmaker authorization read - only Aggregated interfaces (AE) # Increase the number of AE interfaces . set chassis aggregated - devicesethernetdevice - count4 # Create the AE interface and the switching options . set interfaces ae3 description AE - LACP - ULTRABACON - PROXMOX set interfaces ae3 aggregated - ether - options lacp active set interfaces ae3 unit 0 family ethernet - switching port - mode trunk set interfaces ae3 unit 0 family ethernet - switching vlan members 69 set interfaces ae3 unit 0 family ethernet - switching vlan members 99 - 100 set interfaces ae3 unit 0 family ethernet - switching vlan members 210 set interfaces ae3 unit 0 family ethernet - switching vlan members 2001 set interfaces ae3 unit 0 family ethernet - switching native - vlan - id 666 cmaker @ ex2200 - cmaker > show configuration interfaces ge - 0 / 0 / 17 | display set set interfaces ge - 0 / 0 / 17 description LACP - ULTRABACON - PROXMOX set interfaces ge - 0 / 0 / 17 ether - options 802 . 3 ad ae3","title":"Juniper"},{"location":"juniper/#useful-commands","text":"# Show the current configuration . show configuration # Show the logs of the device . show log messsage # Show but compare show | compare # Show but display as a line configuration and not XML . show | display set # Show interface list and status show interfaces terse # Show current hardware show chassis hardware # Show global routing table show route show interface | incl ( proto | Desc ) # Show processus using memory and general system performance stats show system processes summary # Check CPU usage show chassis routing - engine show system process extensive | no - more","title":"Useful commands."},{"location":"juniper/#syslog-configuration","text":"set system syslog user * any emergency set system syslog host 10 . 0 . 99 . 28 any any set system syslog host 10 . 0 . 99 . 28 port 1514 set system syslog file messages any notice set system syslog file messages authorization info set system syslog file interactive - commands interactive - commands any","title":"Syslog configuration."},{"location":"juniper/#radius-configuration","text":"edit set system radius - server $ RADIUS_SERVER_IP_HERE source - address $ SWITCH_IP_HERE set system radius - server $ RADIUS_SERVER_IP_HERE secret $ PASSWORD_HERE set system authentication - order [ radius password ] #Create user profiles based on FreeIPA group. edit system login set user HELPDESK class read - only set user OPERATOR class super - user set user remote full - name \"default remote access user template\" set user remote class read - only","title":"Radius configuration."},{"location":"juniper/#create-a-vlan","text":"set vlans OSTACK - TEST - 1 vlan - id 70","title":"Create a vlan"},{"location":"juniper/#create-a-l3-vlan-interface","text":"set vlans MGMT vlan - id 69 set interfaces ge - 0 / 0 / 23 unit 0 family ethernet - switching port - mode trunk 666 vlan members 69 set interfaces vlan unit 69 family inet address 10 . 10 . 69 . 14 / 24 set vlans MGMT l3 - interface vlan . 69","title":"Create a L3 VLAN interface."},{"location":"juniper/#enable-ssh-with-root-login","text":"set system services ssh root - login allow","title":"Enable SSH with root login."},{"location":"juniper/#create-a-default-route","text":"set routing - options static route 0 . 0 . 0 . 0 / 0 next - hop 10 . 10 . 69 . 1","title":"Create a default route."},{"location":"juniper/#add-a-nameserver-for-dns-resolution","text":"edit system name - server 8 . 8 . 8 . 8","title":"Add a nameserver for DNS resolution."},{"location":"juniper/#upgrade-the-junos-image","text":"request system software add http : // web . weba . ru / pub / 500 G_3 / Firmware / Juniper / 12 . 3 / domestic / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz file copy http : // web . weba . ru / pub / 500 G_3 / Firmware / Juniper / 12 . 3 / domestic / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz / var / tmp / request system software add / var / tmp / jinstall - ex - 2200 - 12 . 3 R5 . 7 - domestic - signed . tgz reboot","title":"Upgrade the JunOS image."},{"location":"juniper/#repair-a-junos-partition-that-rebooted-from-the-backup-partition","text":"*********************************************************************** ** ** ** WARNING : THIS DEVICE HAS BOOTED FROM THE BACKUP JUNOS IMAGE ** ** ** ** It is possible that the primary copy of JUNOS failed to boot up ** ** properly , and so this device has booted from the backup copy . ** ** ** ** Please re - install JUNOS to recover the primary copy in case ** ** it has been corrupted and if auto - snapshot feature is not ** ** enabled . ** ** ** *********************************************************************** show chassis alarms show system storage partitions request system snapshot media internal slice alternate show system snapshot media internal request system reboot slice alternate media internal","title":"Repair a JunOS partition that rebooted from the backup partition."},{"location":"juniper/#create-an-admin-user","text":"set system login user cmaker authentication plain - text - password set system login user cmaker class super - user","title":"Create an admin user."},{"location":"juniper/#add-a-ssh-key-to-a-local-user-for-password-less-auth","text":"set system login user prox - exporter - juniper authentication ssh - rsa \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDJZTRPs8WXsD1yNmWd69/zHNDf4ApvTXDjfk0rxEjgiDsOgWvID0Q8ZH0tFzSV9L0W7a/9jG0POuJyiGYF6M4X2QdEPSZ2CgxRm7GL4A1SJ4xbnCYny2k4L8C7UrDrvqThv6/FyyJopHCPp7S3j0iAI6c+Gtv59sbUvdilWC4Y5LX0ho+yocMaGvTOk+l5aQRU9eWmZsD0/3D0V99iBnm70rlEeEIr1Oe+M+y/Q/0vmBVdC75COCxu84PnLvqPH2yOf3j581wgIVncKbApB0b9ApTbCE94jNljtwM4uGM9qICOf0BwbrDfFT1L1n5ZQx7BZnD9410wv2jTYXTPUJV1\" set system login user prox - exporter - juniper class super - user","title":"Add a SSH key to a local user for password-less auth."},{"location":"juniper/#password-recovery","text":"Boot normally . Prompt : Hit [ Enter ] to boot immediately , or space bar for command prompt . press space during the boot process Type : loader > boot - s Type : Enter full pathname of shell or ' recovery ' for root password recovery or RETURN for / bin / sh : recovery","title":"Password recovery."},{"location":"juniper/#configure-snmp-with-contact-and-location-strings","text":"set snmp name \u201c cmaker - ex2200 \u201d description \u201c cmaker - ex2200 \u201d set snmp location \u201c 9880 Clark \u201d set snmp contact \"laurentfdumont@gmail.com\" set snmp community cmaker authorization read - only","title":"Configure SNMP with contact and location strings."},{"location":"juniper/#aggregated-interfaces-ae","text":"# Increase the number of AE interfaces . set chassis aggregated - devicesethernetdevice - count4 # Create the AE interface and the switching options . set interfaces ae3 description AE - LACP - ULTRABACON - PROXMOX set interfaces ae3 aggregated - ether - options lacp active set interfaces ae3 unit 0 family ethernet - switching port - mode trunk set interfaces ae3 unit 0 family ethernet - switching vlan members 69 set interfaces ae3 unit 0 family ethernet - switching vlan members 99 - 100 set interfaces ae3 unit 0 family ethernet - switching vlan members 210 set interfaces ae3 unit 0 family ethernet - switching vlan members 2001 set interfaces ae3 unit 0 family ethernet - switching native - vlan - id 666 cmaker @ ex2200 - cmaker > show configuration interfaces ge - 0 / 0 / 17 | display set set interfaces ge - 0 / 0 / 17 description LACP - ULTRABACON - PROXMOX set interfaces ge - 0 / 0 / 17 ether - options 802 . 3 ad ae3","title":"Aggregated interfaces (AE)"},{"location":"linux/","text":"Rancid - Check which devices are impacted sort var/logs/VPN.20180109.070410 | grep -i key | uniq Rancid - Only show the device name to pipe into ssh-keygen sort var / logs / VPN . 20180109 . 070410 | grep - i key | uniq | grep - Eo '^[^ ]+' sort / opt / rancid / var / logs / VPN . 20180111 . 064300 | grep - i key | uniq | grep - Eo '^[^ ]+' SSH - Remove the public keys ssh - keygen - f \"/opt/rancid/.ssh/known_hosts\" - R ### REMOTE_IP_OF_DEVICE ### BIND DNS - Check the master zones (not ARPA or random files ) we are hosting ls - alh --ignore=*.arpa* | wc - SMART HD Data - Get useful smartctl data sudo smartctl - a / dev / sdb | egrep \"Spin_Up_Time|Reallocated_Sector_Ct|Temperature|Current_Pending_Sector|Offline_Uncorrectable|Power_On_Hours\" Network - Create TAP Interface tunctl - t tap0 ifconfig tap0 10 . 1 . 1 . 100 netmask 255 . 255 . 255 . 0 up Start Linux stress test screen - S stress - test - d - m stress --cpu 100 --io 100 --vm 20 --vm-bytes 1G --hdd 5 --timeout 24h Install markdown-pdf sudo npm install - g phantomjs --unsafe-perm sudo npm install - g markdown - pdf --unsafe-perm Debug Radius, FreeIPA, LDAP radiusd - X 2 >& 1 | tee debugfile tail - f / var / log / dirsrv / slapd - EVENT - DHMTL - CA / access radtest ldumont user_ldap_password 10 . 0 . 99 . 22 1812 shared_radius_secret ldapwhoami - vvv - h 10 . 0 . 99 . 22 - p 389 - D uid = ldumont , cn = users , cn = accounts , dc = event , dc = dhmtl , dc = ca - x - w user_ldap_password When Windows 10 Creator upgrade breaks Linux Grub set root = ( hd0 , msdos5 ) set prefix = ( hd0 , msdos5 ) / boot / grub insmod normal normal When in the OS - to make the changes permanent. sudo update - grub sudo grub - install disk Upgrading to Debian testing breaks APT when trying to downgrade. Replace \"Ubuntu\" with \"Debian\" if you are running Debian /etc/apt/preferences.d/allow-downgrade Package : * Pin : release a = stable Pin - Priority : 1001 apt - get update apt - get upgrade Remove the file after and apt - get update If you are missing gnome and the display doesn't work sudo apt - get update sudo apt - get upgrade sudo apt - get dist - upgrade sudo apt - get install nvidia - driver sudo shutdown - r now Should be good to go! Unbalanced audio with Pulse audio killall pulseaudio ; rm - r ~/ . config / pulse /* ; rm -r ~/.pulse* pulseaudio -k Reboot! Create GPG key and export the key format for signing Github commits # Create the key gpg -- gen - key # Show the key ID gpg -- list - keys # Set the global Git sign key git config -- global user . signingkey $ KEY_ID_HERE # Set the GPG sign flag to true for all repos . git config -- global commit . gpgsign true # Export the key with \" -----BEGIN PGP PUBLIC KEY BLOCK----- \" gpg -- armor -- export laurentfdumont @ gmail . com > mykey . asc Using the \"ip\" tool to change connecticity\" ip link set $ DEV_NAME down ip link set $ DEV_NAME up ip route add default via $ DEF_GW_IP dev $ DEV_NAME ip addr add $ IP_ADDR_CIDR dev $ DEV_NAME ip addr delete $ IP_ADDR_CIDR dev $ DEV_NAME Fix BR and VMBR Linux bridges filtering LLDP packets https : // interestingtraffic . nl / 2017 / 11 / 21 / an - oddly - specific - post - about - group_fwd_mask / echo 16384 > / sys / class / net / $ VMBR_INTERFACE / bridge / group_fwd_mask Add fish as the default shell for Ubuntu/Debian. sudo apt - get install fish coldadmin @big - potato ~> cat / etc / shells # / etc / shells : valid login shells / bin / sh / bin / bash / bin / rbash / bin / dash / usr / bin / tmux / usr / bin / fish chsh - s / usr / bin / fish One history file for multiple prompts. vim ~/ . bashrc export PROMPT_COMMAND = 'history -a' Enable Terminus Powerline on Ubuntu (font name is Terminess) https : // github . com / powerline / fonts / issues / 210 https : // superuser . com / questions / 886023 / linux - mint - installing - bdf - fonts - with - console - fc - cache - fc - list git clone https : // github . com / powerline / fonts cd fonts . / install . sh cd / etc / fonts / conf . d / sudo rm / etc / fonts / conf . d / 10 * sudo rm - rf 70 - no - bitmaps . conf sudo ln - s .. / conf . avail / 70 - yes - bitmaps . conf . sudo dpkg - reconfigure fontconfig Ubuntu 19.04 - Disable Ubuntu dock completely. https://askubuntu.com/questions/1030138/how-can-i-get-rid-of-the-dock-in-ubuntu-18 cd / usr / share / gnome - shell / extensions / sudo mv ubuntu - dock @ubuntu . com { ,. bak } Change fan speed of a R710 through IPMI. IPMI needs to be enabled in ILO! You need valid credentials! This disables the auto-adjust of the fan speed, be careful of the R710 heating. I am not responsible for fires :) # Get the ENV data from the IPMI ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD sensor reading \"Ambient Temp\" \"FAN 1 RPM\" \"FAN 2 RPM\" \"FAN 3 RPM\" # Enable manual fan control . ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD raw 0 x30 0 x30 0 x01 0 x00 # \"Activating manual fan speeds! (2160 RPM)\" ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD raw 0 x30 0 x30 0 x02 0 xff 0 x09 Check bonding status cat / proc / net / bonding / mgmt cat / proc / net / bonding / $ INTERFACE_NAME_HERE Get low-level interface stats ethtool - S $ INTERFACE_NAME_HERE ethtool - S mgmt - 1 SSH without using all identity files automatically ssh - o \"IdentitiesOnly true\" - v - A user @host Remove resolvctl (issues with OpenVPN DNS being removed) sudo systemctl disable systemd-resolved.service sudo systemctl stop systemd-resolved.service dns = default in [ main ] section of \"sudo vi /etc/NetworkManager/NetworkManager.conf\" sudo rm /etc/resolv.conf sudo service network-manager restart Troubleshoot APT install errors. # Find the correct file from : cd / var / lib / dpkg / info / # In this case , it was the Foreman postinst script cat foreman . postinst # Increase verbosity EXPORT DEBUG = 1 # Run the failing configure package dpkg --configure foreman","title":"Generic Linux"},{"location":"linux/#when-windows-10-creator-upgrade-breaks-linux-grub","text":"set root = ( hd0 , msdos5 ) set prefix = ( hd0 , msdos5 ) / boot / grub insmod normal normal When in the OS - to make the changes permanent. sudo update - grub sudo grub - install disk","title":"When Windows 10 Creator upgrade breaks Linux Grub"},{"location":"linux/#upgrading-to-debian-testing-breaks-apt-when-trying-to-downgrade","text":"Replace \"Ubuntu\" with \"Debian\" if you are running Debian /etc/apt/preferences.d/allow-downgrade Package : * Pin : release a = stable Pin - Priority : 1001 apt - get update apt - get upgrade Remove the file after and apt - get update If you are missing gnome and the display doesn't work sudo apt - get update sudo apt - get upgrade sudo apt - get dist - upgrade sudo apt - get install nvidia - driver sudo shutdown - r now Should be good to go!","title":"Upgrading to Debian testing breaks APT when trying to downgrade."},{"location":"linux/#unbalanced-audio-with-pulse-audio","text":"killall pulseaudio ; rm - r ~/ . config / pulse /* ; rm -r ~/.pulse* pulseaudio -k Reboot!","title":"Unbalanced audio with Pulse audio"},{"location":"linux/#create-gpg-key-and-export-the-key-format-for-signing-github-commits","text":"# Create the key gpg -- gen - key # Show the key ID gpg -- list - keys # Set the global Git sign key git config -- global user . signingkey $ KEY_ID_HERE # Set the GPG sign flag to true for all repos . git config -- global commit . gpgsign true # Export the key with \" -----BEGIN PGP PUBLIC KEY BLOCK----- \" gpg -- armor -- export laurentfdumont @ gmail . com > mykey . asc","title":"Create GPG key and export the key format for signing Github commits"},{"location":"linux/#using-the-ip-tool-to-change-connecticity","text":"ip link set $ DEV_NAME down ip link set $ DEV_NAME up ip route add default via $ DEF_GW_IP dev $ DEV_NAME ip addr add $ IP_ADDR_CIDR dev $ DEV_NAME ip addr delete $ IP_ADDR_CIDR dev $ DEV_NAME","title":"Using the \"ip\" tool to change connecticity\""},{"location":"linux/#fix-br-and-vmbr-linux-bridges-filtering-lldp-packets","text":"https : // interestingtraffic . nl / 2017 / 11 / 21 / an - oddly - specific - post - about - group_fwd_mask / echo 16384 > / sys / class / net / $ VMBR_INTERFACE / bridge / group_fwd_mask","title":"Fix BR and VMBR Linux bridges filtering LLDP packets"},{"location":"linux/#add-fish-as-the-default-shell-for-ubuntudebian","text":"sudo apt - get install fish coldadmin @big - potato ~> cat / etc / shells # / etc / shells : valid login shells / bin / sh / bin / bash / bin / rbash / bin / dash / usr / bin / tmux / usr / bin / fish chsh - s / usr / bin / fish","title":"Add fish as the default shell for Ubuntu/Debian."},{"location":"linux/#one-history-file-for-multiple-prompts","text":"vim ~/ . bashrc export PROMPT_COMMAND = 'history -a'","title":"One history file for multiple prompts."},{"location":"linux/#enable-terminus-powerline-on-ubuntu-font-name-is-terminess","text":"https : // github . com / powerline / fonts / issues / 210 https : // superuser . com / questions / 886023 / linux - mint - installing - bdf - fonts - with - console - fc - cache - fc - list git clone https : // github . com / powerline / fonts cd fonts . / install . sh cd / etc / fonts / conf . d / sudo rm / etc / fonts / conf . d / 10 * sudo rm - rf 70 - no - bitmaps . conf sudo ln - s .. / conf . avail / 70 - yes - bitmaps . conf . sudo dpkg - reconfigure fontconfig","title":"Enable Terminus Powerline on Ubuntu (font name is Terminess)"},{"location":"linux/#ubuntu-1904-disable-ubuntu-dock-completely","text":"https://askubuntu.com/questions/1030138/how-can-i-get-rid-of-the-dock-in-ubuntu-18 cd / usr / share / gnome - shell / extensions / sudo mv ubuntu - dock @ubuntu . com { ,. bak }","title":"Ubuntu 19.04 - Disable Ubuntu dock completely."},{"location":"linux/#change-fan-speed-of-a-r710-through-ipmi","text":"IPMI needs to be enabled in ILO! You need valid credentials! This disables the auto-adjust of the fan speed, be careful of the R710 heating. I am not responsible for fires :) # Get the ENV data from the IPMI ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD sensor reading \"Ambient Temp\" \"FAN 1 RPM\" \"FAN 2 RPM\" \"FAN 3 RPM\" # Enable manual fan control . ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD raw 0 x30 0 x30 0 x01 0 x00 # \"Activating manual fan speeds! (2160 RPM)\" ipmitool - I lanplus - H 10 . 200 . 10 . 113 - U root - P $ PASSWORD raw 0 x30 0 x30 0 x02 0 xff 0 x09","title":"Change fan speed of a R710 through IPMI."},{"location":"linux/#check-bonding-status","text":"cat / proc / net / bonding / mgmt cat / proc / net / bonding / $ INTERFACE_NAME_HERE","title":"Check bonding status"},{"location":"linux/#get-low-level-interface-stats","text":"ethtool - S $ INTERFACE_NAME_HERE ethtool - S mgmt - 1","title":"Get low-level interface stats"},{"location":"linux/#ssh-without-using-all-identity-files-automatically","text":"ssh - o \"IdentitiesOnly true\" - v - A user @host","title":"SSH without using all identity files automatically"},{"location":"linux/#remove-resolvctl-issues-with-openvpn-dns-being-removed","text":"sudo systemctl disable systemd-resolved.service sudo systemctl stop systemd-resolved.service dns = default in [ main ] section of \"sudo vi /etc/NetworkManager/NetworkManager.conf\" sudo rm /etc/resolv.conf sudo service network-manager restart","title":"Remove resolvctl (issues with OpenVPN DNS being removed)"},{"location":"linux/#troubleshoot-apt-install-errors","text":"# Find the correct file from : cd / var / lib / dpkg / info / # In this case , it was the Foreman postinst script cat foreman . postinst # Increase verbosity EXPORT DEBUG = 1 # Run the failing configure package dpkg --configure foreman","title":"Troubleshoot APT install errors."},{"location":"lvm/","text":"Reduce swap and extend other LVM module # Disable swap temporarly. swapoff -a # Reduce swap paritition. lvreduce /dev/superbacon-vg/swap_1 -L -67G # Extend LVM root paritition. lvextend /dev/superbacon-vg/root -L +67G # Extend actual partition size. resize2fs /dev/superbacon-vg/root # Recreate swap partition mkswap /dev/superbacon-vg/swap_1 # Re-enable swap partition swapon -a ----------------- Mount partition from existing VG/LV ----------------- # Create an ext4 partition. mkfs.ext4 /dev/vg-storage/lv-storage # Mount the partition to test. mount -t ext4 /dev/vg-storage/lv-storage /mnt # Mount in /etc/fstab /dev/mapper/vg--storage-lv--storage /storage ext4 defaults,nofail 0 1 7 echo \" deb http://download.proxmox.com/debian/pve stretch pve-no-subscription \" > / etc / apt / sources . list . d / pve - install - repo . list 8 wget http : // download . proxmox . com / debian / proxmox - ve - release - 5 . x . gpg - O / etc / apt / trusted . gpg . d / proxmox - ve - release - 5 . x . gpg 9 apt update && apt dist - upgrade 10 apt install proxmox - ve postfix open - iscsi 11 clear 12 shutdown - r now 13 mount / dev / sdb1 / storage 14 mkdir / storage 15 mount / dev / sdb1 / storage 16 mount / dev / sdb / storage 17 mount - t ext4 / dev / sdb / storage 18 dmesg | tail 19 fdisk - l 20 lvdisplay 21 vgdisplay 22 vgscan 23 fdisk - l 24 clear 25 vgdisplay 26 lvmdiskscan 27 vgcreate 28 vgcreate / dev / sdb1 29 pvs 30 vgcreate vg - storage / dev / sdb1 31 vgdisplay 32 man lvcreate 33 lvcreate - n storage - l 100 % FREE vg - storage 34 lvdisplay 35 clear 36 mkfs . ext4 / dev / vg - storage / storage 37 lvdisplay 38 man mount 39 man mount 40 man mount 41 mount - t ext4 / dev / vg - storage / storage / storage 42 cd / storage 43 mkdir tata 44 ls 45 rm tata 46 rm - rf tata 47 clear 48 exit 49 history","title":"LVM"},{"location":"lvm/#reduce-swap-and-extend-other-lvm-module","text":"# Disable swap temporarly. swapoff -a # Reduce swap paritition. lvreduce /dev/superbacon-vg/swap_1 -L -67G # Extend LVM root paritition. lvextend /dev/superbacon-vg/root -L +67G # Extend actual partition size. resize2fs /dev/superbacon-vg/root # Recreate swap partition mkswap /dev/superbacon-vg/swap_1 # Re-enable swap partition swapon -a ----------------- Mount partition from existing VG/LV ----------------- # Create an ext4 partition. mkfs.ext4 /dev/vg-storage/lv-storage # Mount the partition to test. mount -t ext4 /dev/vg-storage/lv-storage /mnt # Mount in /etc/fstab /dev/mapper/vg--storage-lv--storage /storage ext4 defaults,nofail 0 1 7 echo \" deb http://download.proxmox.com/debian/pve stretch pve-no-subscription \" > / etc / apt / sources . list . d / pve - install - repo . list 8 wget http : // download . proxmox . com / debian / proxmox - ve - release - 5 . x . gpg - O / etc / apt / trusted . gpg . d / proxmox - ve - release - 5 . x . gpg 9 apt update && apt dist - upgrade 10 apt install proxmox - ve postfix open - iscsi 11 clear 12 shutdown - r now 13 mount / dev / sdb1 / storage 14 mkdir / storage 15 mount / dev / sdb1 / storage 16 mount / dev / sdb / storage 17 mount - t ext4 / dev / sdb / storage 18 dmesg | tail 19 fdisk - l 20 lvdisplay 21 vgdisplay 22 vgscan 23 fdisk - l 24 clear 25 vgdisplay 26 lvmdiskscan 27 vgcreate 28 vgcreate / dev / sdb1 29 pvs 30 vgcreate vg - storage / dev / sdb1 31 vgdisplay 32 man lvcreate 33 lvcreate - n storage - l 100 % FREE vg - storage 34 lvdisplay 35 clear 36 mkfs . ext4 / dev / vg - storage / storage 37 lvdisplay 38 man mount 39 man mount 40 man mount 41 mount - t ext4 / dev / vg - storage / storage / storage 42 cd / storage 43 mkdir tata 44 ls 45 rm tata 46 rm - rf tata 47 clear 48 exit 49 history","title":"Reduce swap and extend other LVM module"},{"location":"maas/","text":"Adding a custom power provider for MAAS. Install proxmoxer for Python3 pip3 install proxmoxer Proxmox Script - source https://bugs.launchpad.net/maas/+bug/1805799 # Copyright 2018 Wojciech Rakoniewski # This software is licensed under the # GNU Affero General Public License version 3 (see the file LICENSE). # # tested on Proxmox VE 5.2-11 but should work with any version # libraries: proxmoxer # tested with version 1.02 installed using apt \"\"\"Proxmox Power Driver for MAAS\"\"\" __all__ = [ \"ProxmoxError\" , \"ProxmoxPowerDriver\" ] from provisioningserver.drivers import ( make_ip_extractor , make_setting_field , SETTING_SCOPE , ) from provisioningserver.drivers.power import ( PowerDriver , PowerError ) try : from proxmoxer import ProxmoxAPI PROXMOXER_IMPORTED = True except ImportError : PROXMOXER_IMPORTED = False PROXMOX_YES = \"y\" PROXMOX_NO = \"n\" PROXMOX_VALIDATE_SSL_CHOICES = [ [ PROXMOX_YES , \"Yes\" ], [ PROXMOX_NO , \"No\" ]] class ProxmoxError ( PowerError ): \"\"\"Failure communicating to proxmox \"\"\" class ProxmoxPowerDriver ( PowerDriver ): name = 'proxmox' chassis = True description = \"Proxmox (virtual systems)\" settings = [ make_setting_field ( 'power_vm_name' , \"VM id or name\" , required = True , scope = SETTING_SCOPE . NODE ), make_setting_field ( 'power_address' , \"Proxmox host name or ip\" , required = True ), make_setting_field ( 'power_user' , \"Proxmox username (user@realm)\" , required = True ), make_setting_field ( 'power_pass' , \"Proxmox password\" , field_type = 'password' , required = True ), make_setting_field ( 'power_ssl_validate' , \"Validate ssl\" , field_type = 'choice' , required = True , choices = PROXMOX_VALIDATE_SSL_CHOICES , default = PROXMOX_NO ), ] ip_extractor = make_ip_extractor ( 'power_address' ) def detect_missing_packages ( self ): if not PROXMOXER_IMPORTED : return [ \"python3-proxmoxer\" ] return [] def power_on ( self , system_id , context ): \"\"\"Power on Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) vm . status . start . post (); def power_off ( self , system_id , context ): \"\"\"Power off Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) vm . status . stop . post (); def power_query ( self , system_id , context ): \"\"\"Power query Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) ncd = vm . status . current . get () if ncd [ 'status' ] == 'running' : return \"on\" else : return \"off\" def __proxmox_login ( self , system_id , context ): \"\"\"Login to proxmox server.\"\"\" api_host = context . get ( 'power_address' ) api_user = context . get ( 'power_user' ) api_password = context . get ( 'power_pass' ) vm_id = context . get ( 'power_vm_name' ) api_ssl_val = ( context . get ( 'power_validate_ssl' ) == PROXMOX_YES ) try : api = ProxmoxAPI ( api_host , user = api_user , password = api_password , verify_ssl = api_ssl_val ) con_vm = None for vm in api . cluster . resources . get ( type = \"vm\" ): if ( str ( vm [ 'vmid' ]) == vm_id ) or ( vm [ 'name' ] == vm_id ): con_vm = vm break except Exception : raise ProxmoxError ( \"Can't connect to proxmox cluster %s \" % ( api_host )) if con_vm is None : \"\"\"vm not found\"\"\" raise ProxmoxError ( \"Virtual machine %s not found on proxmox cluster %s \" % ( vm_id , api_host )) #extract node object vm_obj = getattr ( getattr ( getattr ( api . nodes , con_vm [ 'node' ]), con_vm [ 'type' ]), str ( con_vm [ 'vmid' ])) return vm_obj Location of the power scripts for MAAS. / usr / lib / python3 / dist - packages / provisioningserver / drivers / power / proxmox . py / usr / lib / python3 / dist - packages / provisioningserver / drivers / power / registry . py Edit registry.py and add the following lines to the bottom of the import section. from provisioningserver.drivers.power.proxmox import ProxmoxPowerDriver Add the following line to the bottom of the power_drivers array. ProxmoxPowerDriver (), # Register all the power drivers . power_drivers = [ AMTPowerDriver (), APCPowerDriver (), DLIPowerDriver (), FenceCDUPowerDriver (), HMCPowerDriver (), IPMIPowerDriver (), ManualPowerDriver (), MoonshotIPMIPowerDriver (), MSCMPowerDriver (), MicrosoftOCSPowerDriver (), NovaPowerDriver (), RECSPowerDriver (), SeaMicroPowerDriver (), UCSMPowerDriver (), VirshPowerDriver (), VMwarePowerDriver (), WedgePowerDriver (), ProxmoxPowerDriver (), ] Restart the rack controller. systemctl restart maas - rackd","title":"MAAS"},{"location":"maas/#adding-a-custom-power-provider-for-maas","text":"","title":"Adding a custom power provider for MAAS."},{"location":"maas/#install-proxmoxer-for-python3","text":"pip3 install proxmoxer","title":"Install proxmoxer for Python3"},{"location":"maas/#proxmox-script-source-httpsbugslaunchpadnetmaasbug1805799","text":"# Copyright 2018 Wojciech Rakoniewski # This software is licensed under the # GNU Affero General Public License version 3 (see the file LICENSE). # # tested on Proxmox VE 5.2-11 but should work with any version # libraries: proxmoxer # tested with version 1.02 installed using apt \"\"\"Proxmox Power Driver for MAAS\"\"\" __all__ = [ \"ProxmoxError\" , \"ProxmoxPowerDriver\" ] from provisioningserver.drivers import ( make_ip_extractor , make_setting_field , SETTING_SCOPE , ) from provisioningserver.drivers.power import ( PowerDriver , PowerError ) try : from proxmoxer import ProxmoxAPI PROXMOXER_IMPORTED = True except ImportError : PROXMOXER_IMPORTED = False PROXMOX_YES = \"y\" PROXMOX_NO = \"n\" PROXMOX_VALIDATE_SSL_CHOICES = [ [ PROXMOX_YES , \"Yes\" ], [ PROXMOX_NO , \"No\" ]] class ProxmoxError ( PowerError ): \"\"\"Failure communicating to proxmox \"\"\" class ProxmoxPowerDriver ( PowerDriver ): name = 'proxmox' chassis = True description = \"Proxmox (virtual systems)\" settings = [ make_setting_field ( 'power_vm_name' , \"VM id or name\" , required = True , scope = SETTING_SCOPE . NODE ), make_setting_field ( 'power_address' , \"Proxmox host name or ip\" , required = True ), make_setting_field ( 'power_user' , \"Proxmox username (user@realm)\" , required = True ), make_setting_field ( 'power_pass' , \"Proxmox password\" , field_type = 'password' , required = True ), make_setting_field ( 'power_ssl_validate' , \"Validate ssl\" , field_type = 'choice' , required = True , choices = PROXMOX_VALIDATE_SSL_CHOICES , default = PROXMOX_NO ), ] ip_extractor = make_ip_extractor ( 'power_address' ) def detect_missing_packages ( self ): if not PROXMOXER_IMPORTED : return [ \"python3-proxmoxer\" ] return [] def power_on ( self , system_id , context ): \"\"\"Power on Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) vm . status . start . post (); def power_off ( self , system_id , context ): \"\"\"Power off Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) vm . status . stop . post (); def power_query ( self , system_id , context ): \"\"\"Power query Proxmox node.\"\"\" vm = self . __proxmox_login ( system_id , context ) ncd = vm . status . current . get () if ncd [ 'status' ] == 'running' : return \"on\" else : return \"off\" def __proxmox_login ( self , system_id , context ): \"\"\"Login to proxmox server.\"\"\" api_host = context . get ( 'power_address' ) api_user = context . get ( 'power_user' ) api_password = context . get ( 'power_pass' ) vm_id = context . get ( 'power_vm_name' ) api_ssl_val = ( context . get ( 'power_validate_ssl' ) == PROXMOX_YES ) try : api = ProxmoxAPI ( api_host , user = api_user , password = api_password , verify_ssl = api_ssl_val ) con_vm = None for vm in api . cluster . resources . get ( type = \"vm\" ): if ( str ( vm [ 'vmid' ]) == vm_id ) or ( vm [ 'name' ] == vm_id ): con_vm = vm break except Exception : raise ProxmoxError ( \"Can't connect to proxmox cluster %s \" % ( api_host )) if con_vm is None : \"\"\"vm not found\"\"\" raise ProxmoxError ( \"Virtual machine %s not found on proxmox cluster %s \" % ( vm_id , api_host )) #extract node object vm_obj = getattr ( getattr ( getattr ( api . nodes , con_vm [ 'node' ]), con_vm [ 'type' ]), str ( con_vm [ 'vmid' ])) return vm_obj","title":"Proxmox Script - source https://bugs.launchpad.net/maas/+bug/1805799"},{"location":"maas/#location-of-the-power-scripts-for-maas","text":"/ usr / lib / python3 / dist - packages / provisioningserver / drivers / power / proxmox . py / usr / lib / python3 / dist - packages / provisioningserver / drivers / power / registry . py","title":"Location of the power scripts for MAAS."},{"location":"maas/#edit-registrypy-and-add-the-following-lines-to-the-bottom-of-the-import-section","text":"from provisioningserver.drivers.power.proxmox import ProxmoxPowerDriver","title":"Edit registry.py and add the following lines to the bottom of the import section."},{"location":"maas/#add-the-following-line-to-the-bottom-of-the-power_drivers-array","text":"ProxmoxPowerDriver (), # Register all the power drivers . power_drivers = [ AMTPowerDriver (), APCPowerDriver (), DLIPowerDriver (), FenceCDUPowerDriver (), HMCPowerDriver (), IPMIPowerDriver (), ManualPowerDriver (), MoonshotIPMIPowerDriver (), MSCMPowerDriver (), MicrosoftOCSPowerDriver (), NovaPowerDriver (), RECSPowerDriver (), SeaMicroPowerDriver (), UCSMPowerDriver (), VirshPowerDriver (), VMwarePowerDriver (), WedgePowerDriver (), ProxmoxPowerDriver (), ]","title":"Add the following line to the bottom of the power_drivers array."},{"location":"maas/#restart-the-rack-controller","text":"systemctl restart maas - rackd","title":"Restart the rack controller."},{"location":"molecule/","text":"Testing framework for Ansible. Installation Ubuntu 18.04 LTS sudo apt - get install - y python - pip libssl - dev pip install --user molecule Create a test setup in an existing role # From within the role folder molecule init scenario - r my - role - name Start a full testing run sudo molecule test","title":"Molecule"},{"location":"molecule/#testing-framework-for-ansible","text":"","title":"Testing framework for Ansible."},{"location":"molecule/#installation-ubuntu-1804-lts","text":"sudo apt - get install - y python - pip libssl - dev pip install --user molecule","title":"Installation Ubuntu 18.04 LTS"},{"location":"molecule/#create-a-test-setup-in-an-existing-role","text":"# From within the role folder molecule init scenario - r my - role - name","title":"Create a test setup in an existing role"},{"location":"molecule/#start-a-full-testing-run","text":"sudo molecule test","title":"Start a full testing run"},{"location":"mysql/","text":"Create Database and user. CREATE DATABASE `racktables` ; CREATE USER 'racktables_user' IDENTIFIED BY 'test' ; GRANT ALL privileges ON `racktables` . * TO 'racktables_user' @ '%' ; CREATE DATABASE `netbox` ; CREATE USER 'netbox_user' IDENTIFIED BY 'test' ; GRANT ALL privileges ON `netbox` . * TO 'netbox_user' @ '%' ;","title":"MySQL/MariaDB"},{"location":"mysql/#create-database-and-user","text":"CREATE DATABASE `racktables` ; CREATE USER 'racktables_user' IDENTIFIED BY 'test' ; GRANT ALL privileges ON `racktables` . * TO 'racktables_user' @ '%' ; CREATE DATABASE `netbox` ; CREATE USER 'netbox_user' IDENTIFIED BY 'test' ; GRANT ALL privileges ON `netbox` . * TO 'netbox_user' @ '%' ;","title":"Create Database and user."},{"location":"netbox/","text":"apt-get update apt-get install -y postgresql libpq-dev sudo -u postgres psql CREATE DATABASE netbox ; CREATE USER netbox WITH PASSWORD 'bigpotato' ; GRANT ALL PRIVILEGES ON DATABASE netbox TO netbox ; \\q apt-get install -y python3 python3-dev python3-setuptools build-essential libxml2-dev libxslt1-dev libffi-dev graphviz libpq-dev libssl-dev zlib1g-dev easy_install3 pip mkdir -p /opt/netbox/ && cd /opt/netbox/ git clone -b master https://github.com/digitalocean/netbox.git . pip3 install -r requirements.txt pip3 install napalm sudo apt-get install libapache2-mod-wsgi sudo a2enmod wsgi sudo a2enmod proxy sudo a2enmod proxy_http sudo a2enmod headers sudo a2ensite netbox sudo service apache2 restart <VirtualHost *:80 > ServerName netbox.northernsysadmin.com Redirect permanent / https://netbox.northernsysadmin.com/ </VirtualHost> <VirtualHost *:443 > SSLEngine on SSLCertificateFile $FULL_CHAIN_CERT_HERE SSLCertificateKeyFile $PRIVATE_KEY_CERT_HERE ProxyPreserveHost On ServerName netbox.northernsysadmin.com Alias /static /opt/netbox/netbox/static # Needed to allow token-based API authentication WSGIPassAuthorization on <Directory / > SetEnvIfNoCase Host netbox.northernsysadmin\\.com VALID_HOST Order Deny,Allow Deny from All Allow from env=VALID_HOST </Directory> <Directory /opt/netbox/netbox/static > Options Indexes FollowSymLinks MultiViews AllowOverride None Require all granted </Directory> <Location /static > ProxyPass ! </Location> RequestHeader set \"X-Forwarded-Proto\" expr=%{REQUEST_SCHEME} ProxyPass / http://127.0.0.1:8001/ ProxyPassReverse / http://127.0.0.1:8001/ </VirtualHost>","title":"Netbox"},{"location":"openstack/","text":"07d76f4e-c920-49ea-af06-bd3c322f16cf openstack router set --external-gateway EXT_NET --enable-snat --fixed-ip subnet = EXT_SUB,ip-address = 192 .168.70.2 neutron net-create PROV_NET --shared --router:external True --provider:physical_network physnet1 --provider:network_type vlan --provider:segmentation_id 71 neutron subnet-create PROV_NET --name PROV_SUB --disable-dhcp --gateway 192 .168.71.1 192 .168.71.0/24 neutron net-create EXT_NET --router:external True --provider:physical_network physnet1 --provider:network_type vlan --provider:segmentation_id 70 neutron subnet-create EXT_NET --name EXT_SUB --allocation-pool start = 192 .168.70.10,end = 192 .168.70.100 --disable-dhcp --gateway 192 .168.70.1 192 .168.70.0/24 network : e23f7863-6e84-4395-bbbb-45877e950f2a subnet : 5bee0941-8d7f-4869-896d-e34e1f2e8b3d 9ce38b2c-b13b-4e65-8e68-32b146115a62 : openstack port create --fixed-ip subnet = 5bee0941-8d7f-4869-896d-e34e1f2e8b3d,ip-address = 10 .100.100.10 --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus_1 eefa2140-fd69-4daf-8b0d-0eafcf3e24b9 : openstack port create --fixed-ip subnet = 5bee0941-8d7f-4869-896d-e34e1f2e8b3d,ip-address = 10 .100.100.11 --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus_2 815 neutron net-create PROV_NET --router:external True --provider:physical_network physnet1 --provider:network_type vlan --provider:segmentation_id 71 816 neutron subnet-create PROV_NET --name PROV_SUB --allocation-pool start = 192 .168.71.10,end = 192 .168.71.100 --disable-dhcp --gateway 192 .168.71.1 192 .168.71.0/24 822 neutron net-create PROV_NET --shared --router:external True --provider:physical_network physnet1 --provider:network_type vlan --provider:segmentation_id 71 823 neutron subnet-create PROV_NET --name PROV_SUB --disable-dhcp --gateway 192 .168.71.1 192 .168.71.0/24 Random useful commands openstack server list --all -c ID -c Name --host $NOVA_COMPUTE_NAME_HERE -f value Upload custom image openstack image create --disk-format qcow2 --container-format bare --public --file ./cirros-0.4.0-x86_64-disk.img cirros-0.4.0 Create flavor openstack flavor create --ram 1024 --disk 10 --vcpus 1 --public small-flavor Create VM openstack server create --image e090519f-91f6-4c21-baf5-08642d0bd28b --flavor f60498da-a9a9-4772-a05c-75b4aaa6389a --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus-1 openstack server create --image e090519f-91f6-4c21-baf5-08642d0bd28b --flavor f60498da-a9a9-4772-a05c-75b4aaa6389a --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus-2 Compute node requirements https : // docs . openstack . org / nova / rocky / install / compute - install - rdo . html https : // docs . openstack . org / neutron / rocky / install / compute - install - rdo . html https : // docs . openstack . org / neutron / rocky / install / compute - install - option1 - rdo . html Create a external network with a subnet attached to that network. neutron net - create EXT_NET -- router : external True -- provider : physical_network physnet1 -- provider : network_type vlan -- provider : segmentation_id 70 neutron subnet - create EXT_NET -- name EXT_SUB -- allocation - pool start = 192 . 168 . 70 . 10 , end = 192 . 168 . 70 . 100 -- disable - dhcp -- gateway 192 . 168 . 70 . 1 192 . 168 . 70 . 0 / 24 Random commands # Create image openstack image create --disk-format qcow2 --container-format bare --public --file ./cirros-0.4.0-x86_64-disk.img cirros-0.4.0 # Create flavor openstack flavor create --ram 1024 --disk 10 --vcpus 1 --public small-flavor # Create network openstack network create network - floating - ip1 openstack floating ip create --subnet floating-ip-1 # Create provider network with vlan openstack network create --share --provider-physical-network provider --provider-network-type vlan provider1 / etc / hosts 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 5 compute03 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 4 compute02 Placeholder password : openstack2019 RABBIT_PASS : openstack2019 rabbitmqctl add_user openstack openstack2019 GRANT ALL PRIVILEGES ON keystone . * TO 'keystone' @ 'localhost' \\ IDENTIFIED BY 'openstack2019' ; GRANT ALL PRIVILEGES ON keystone . * TO 'keystone' @ '%' \\ IDENTIFIED BY 'openstack2019' ; connection = mysql + pymysql : // keystone : openstack2019 @controller01 / keystone keystone - manage bootstrap --bootstrap-password openstack2019 \\ --bootstrap-admin-url http://controller01:5000/v3/ \\ --bootstrap-internal-url http://controller01:5000/v3/ \\ --bootstrap-public-url http://controller01:5000/v3/ \\ --bootstrap-region-id RegionOne export OS_USERNAME = admin export OS_PASSWORD = openstack2019 export OS_PROJECT_NAME = admin export OS_USER_DOMAIN_NAME = Default export OS_PROJECT_DOMAIN_NAME = Default export OS_AUTH_URL = http : // controller01 : 5000 / v3 export OS_IDENTITY_API_VERSION = 3 openstack domain create --description \"Test Domain\" example openstack project create --domain default \\ --description \"Service Project\" service GRANT ALL PRIVILEGES ON glance . * TO 'glance' @ 'localhost' \\ IDENTIFIED BY 'openstack2019' ; GRANT ALL PRIVILEGES ON glance . * TO 'glance' @ '%' \\ IDENTIFIED BY 'openstack2019' ; www_authenticate_uri = http : // controller01 : 5000 auth_url = http : // controller01 : 5000 memcached_servers = controller01 : 11211 auth_type = password project_domain_name = Default user_domain_name = Default project_name = service username = glance password = openstack2019 ### Deploy Compute NOVA service on Controller node . CREATE DATABASE nova_api ; CREATE DATABASE nova ; CREATE DATABASE nova_cell0 ; CREATE DATABASE placement ; GRANT ALL PRIVILEGES ON nova_api . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_api . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_cell0 . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_cell0 . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON placement . * TO ' placement ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON placement . * TO ' placement ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; openstack user create -- domain default -- password - prompt nova openstack role add -- project service -- user nova admin openstack service create -- name nova \\ -- description \" OpenStack Compute \" compute openstack endpoint create -- region RegionOne \\ compute public http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ compute internal http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ compute admin http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ placement public http : // controller01 : 8778 openstack endpoint create -- region RegionOne \\ placement internal http : // controller01 : 8778 openstack endpoint create -- region RegionOne \\ placement admin http : // controller01 : 8778 modprobe br_netfilter echo \" $(sysctl -w net.bridge.bridge-nf-call-iptables=1) \" >> / etc / sysctl . conf echo \" $(sysctl -w net.bridge.bridge-nf-call-ip6tables=1) \" >> / etc / sysctl . conf sysctl - p / etc / sysctl . conf GRANT ALL PRIVILEGES ON neutron . * TO ' neutron ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON neutron . * TO ' neutron ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; openstack endpoint create -- region RegionOne \\ network public http : // controller01 : 9696 openstack endpoint create -- region RegionOne \\ network internal http : // controller01 : 9696 openstack endpoint create -- region RegionOne \\ network admin http : // controller01 : 9696 openstack subnet create -- network provider \\ -- allocation - pool start = 10 . 13 . 0 . 100 , end = 10 . 13 . 0 . 200 \\ -- dns - nameserver 10 . 13 . 0 . 1 -- gateway 10 . 13 . 0 . 1 \\ -- subnet - range 10 . 13 . 0 . 0 / 24 provider openstack server create -- flavor m1 . nano -- image cirros \\ -- nic net - id = dee9dde7 - 0 edb - 4311 - a06e - 5 ffb98144527 -- security - group default \\ provider - instance nova - manage cell_v2 map_cell0 nova - manage db sync","title":"Openstack"},{"location":"openstack/#random-useful-commands","text":"openstack server list --all -c ID -c Name --host $NOVA_COMPUTE_NAME_HERE -f value","title":"Random useful commands"},{"location":"openstack/#upload-custom-image","text":"openstack image create --disk-format qcow2 --container-format bare --public --file ./cirros-0.4.0-x86_64-disk.img cirros-0.4.0","title":"Upload custom image"},{"location":"openstack/#create-flavor","text":"openstack flavor create --ram 1024 --disk 10 --vcpus 1 --public small-flavor","title":"Create flavor"},{"location":"openstack/#create-vm","text":"openstack server create --image e090519f-91f6-4c21-baf5-08642d0bd28b --flavor f60498da-a9a9-4772-a05c-75b4aaa6389a --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus-1 openstack server create --image e090519f-91f6-4c21-baf5-08642d0bd28b --flavor f60498da-a9a9-4772-a05c-75b4aaa6389a --network e23f7863-6e84-4395-bbbb-45877e950f2a cumulus-2","title":"Create VM"},{"location":"openstack/#compute-node-requirements","text":"https : // docs . openstack . org / nova / rocky / install / compute - install - rdo . html https : // docs . openstack . org / neutron / rocky / install / compute - install - rdo . html https : // docs . openstack . org / neutron / rocky / install / compute - install - option1 - rdo . html","title":"Compute node requirements"},{"location":"openstack/#create-a-external-network-with-a-subnet-attached-to-that-network","text":"neutron net - create EXT_NET -- router : external True -- provider : physical_network physnet1 -- provider : network_type vlan -- provider : segmentation_id 70 neutron subnet - create EXT_NET -- name EXT_SUB -- allocation - pool start = 192 . 168 . 70 . 10 , end = 192 . 168 . 70 . 100 -- disable - dhcp -- gateway 192 . 168 . 70 . 1 192 . 168 . 70 . 0 / 24","title":"Create a external network with a subnet attached to that network."},{"location":"openstack/#random-commands","text":"# Create image openstack image create --disk-format qcow2 --container-format bare --public --file ./cirros-0.4.0-x86_64-disk.img cirros-0.4.0 # Create flavor openstack flavor create --ram 1024 --disk 10 --vcpus 1 --public small-flavor # Create network openstack network create network - floating - ip1 openstack floating ip create --subnet floating-ip-1 # Create provider network with vlan openstack network create --share --provider-physical-network provider --provider-network-type vlan provider1 / etc / hosts 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 4 compute02 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 5 compute03 ################################ 10 . 12 . 0 . 5 compute03 10 . 12 . 0 . 2 controller01 10 . 12 . 0 . 3 compute01 10 . 12 . 0 . 4 compute02 Placeholder password : openstack2019 RABBIT_PASS : openstack2019 rabbitmqctl add_user openstack openstack2019 GRANT ALL PRIVILEGES ON keystone . * TO 'keystone' @ 'localhost' \\ IDENTIFIED BY 'openstack2019' ; GRANT ALL PRIVILEGES ON keystone . * TO 'keystone' @ '%' \\ IDENTIFIED BY 'openstack2019' ; connection = mysql + pymysql : // keystone : openstack2019 @controller01 / keystone keystone - manage bootstrap --bootstrap-password openstack2019 \\ --bootstrap-admin-url http://controller01:5000/v3/ \\ --bootstrap-internal-url http://controller01:5000/v3/ \\ --bootstrap-public-url http://controller01:5000/v3/ \\ --bootstrap-region-id RegionOne export OS_USERNAME = admin export OS_PASSWORD = openstack2019 export OS_PROJECT_NAME = admin export OS_USER_DOMAIN_NAME = Default export OS_PROJECT_DOMAIN_NAME = Default export OS_AUTH_URL = http : // controller01 : 5000 / v3 export OS_IDENTITY_API_VERSION = 3 openstack domain create --description \"Test Domain\" example openstack project create --domain default \\ --description \"Service Project\" service GRANT ALL PRIVILEGES ON glance . * TO 'glance' @ 'localhost' \\ IDENTIFIED BY 'openstack2019' ; GRANT ALL PRIVILEGES ON glance . * TO 'glance' @ '%' \\ IDENTIFIED BY 'openstack2019' ; www_authenticate_uri = http : // controller01 : 5000 auth_url = http : // controller01 : 5000 memcached_servers = controller01 : 11211 auth_type = password project_domain_name = Default user_domain_name = Default project_name = service username = glance password = openstack2019 ### Deploy Compute NOVA service on Controller node . CREATE DATABASE nova_api ; CREATE DATABASE nova ; CREATE DATABASE nova_cell0 ; CREATE DATABASE placement ; GRANT ALL PRIVILEGES ON nova_api . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_api . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_cell0 . * TO ' nova ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON nova_cell0 . * TO ' nova ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON placement . * TO ' placement ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON placement . * TO ' placement ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; openstack user create -- domain default -- password - prompt nova openstack role add -- project service -- user nova admin openstack service create -- name nova \\ -- description \" OpenStack Compute \" compute openstack endpoint create -- region RegionOne \\ compute public http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ compute internal http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ compute admin http : // controller01 : 8774 / v2 . 1 openstack endpoint create -- region RegionOne \\ placement public http : // controller01 : 8778 openstack endpoint create -- region RegionOne \\ placement internal http : // controller01 : 8778 openstack endpoint create -- region RegionOne \\ placement admin http : // controller01 : 8778 modprobe br_netfilter echo \" $(sysctl -w net.bridge.bridge-nf-call-iptables=1) \" >> / etc / sysctl . conf echo \" $(sysctl -w net.bridge.bridge-nf-call-ip6tables=1) \" >> / etc / sysctl . conf sysctl - p / etc / sysctl . conf GRANT ALL PRIVILEGES ON neutron . * TO ' neutron ' @ ' localhost ' \\ IDENTIFIED BY ' openstack2019 ' ; GRANT ALL PRIVILEGES ON neutron . * TO ' neutron ' @ ' % ' \\ IDENTIFIED BY ' openstack2019 ' ; openstack endpoint create -- region RegionOne \\ network public http : // controller01 : 9696 openstack endpoint create -- region RegionOne \\ network internal http : // controller01 : 9696 openstack endpoint create -- region RegionOne \\ network admin http : // controller01 : 9696 openstack subnet create -- network provider \\ -- allocation - pool start = 10 . 13 . 0 . 100 , end = 10 . 13 . 0 . 200 \\ -- dns - nameserver 10 . 13 . 0 . 1 -- gateway 10 . 13 . 0 . 1 \\ -- subnet - range 10 . 13 . 0 . 0 / 24 provider openstack server create -- flavor m1 . nano -- image cirros \\ -- nic net - id = dee9dde7 - 0 edb - 4311 - a06e - 5 ffb98144527 -- security - group default \\ provider - instance nova - manage cell_v2 map_cell0 nova - manage db sync","title":"Random commands"},{"location":"ovs/","text":"Useful commands ovs - vsctl list interface ovs - vsctl list port ovs - vsctl show ovs - appctl fdb / show mybridge","title":"OVS"},{"location":"ovs/#useful-commands","text":"ovs - vsctl list interface ovs - vsctl list port ovs - vsctl show ovs - appctl fdb / show mybridge","title":"Useful commands"},{"location":"postgres/","text":"Create a database and a user with admin privileges sudo apt - get install postgresql postgresql - client sudo - u postgres psql create database netbox ; create user netbox_user with encrypted password 'test' ; grant all privileges on database netbox to netbox_user ;","title":"Postgres"},{"location":"postgres/#create-a-database-and-a-user-with-admin-privileges","text":"sudo apt - get install postgresql postgresql - client sudo - u postgres psql create database netbox ; create user netbox_user with encrypted password 'test' ; grant all privileges on database netbox to netbox_user ;","title":"Create a database and a user with admin privileges"},{"location":"prometheus/","text":"# Docker volume - Prometheus config sudo docker volume create prometheus - config # Docker volume - Prometheus metrics and adata sudo docker volume create prometheus - data sudo docker run - d - p 9090 : 9090 - v prometheus - config : / prometheus - config - v prometheus - data : / prometheus prom / prometheus --config.file=/prometheus-config/prometheus.yml Grafana container sudo docker volume create grafana - config sudo docker run \\ - d \\ - p 3000 : 3000 \\ --name=grafana \\ - v grafana - storage : / var / lib / grafana \\ - e \"GF_SECURITY_ADMIN_PASSWORD=PASSWORD_HERE\" \\ grafana / grafana Blackbox exporter docker run -- rm - d - p 9115 : 9115 -- name blackbox_exporter - v `pwd` : / config prom / blackbox - exporter : master -- config . file =/ config / blackbox . yml","title":"Prometheus"},{"location":"security/","text":"Disable RPCBind. systemctl stop rpcbind . socket systemctl disable rpcbind . socket systemctl stop rpcbind systemctl disable rpcbind netstat - punta | grep 111","title":"Security"},{"location":"security/#disable-rpcbind","text":"systemctl stop rpcbind . socket systemctl disable rpcbind . socket systemctl stop rpcbind systemctl disable rpcbind netstat - punta | grep 111","title":"Disable RPCBind."},{"location":"splunk/","text":"Clear the splunk index and all data gathered. Will delete most of the existing data! cd / opt / splunk / bin . / splunk stop . / splunk clean eventdata . / splunk start","title":"Splunk"},{"location":"terraform/","text":"Deployment flow terraform init terraform apply Terraform debug TF_LOG = DEBUG OS_DEBUG = 1 terraform apply","title":"Terraform"},{"location":"terraform/#deployment-flow","text":"terraform init terraform apply","title":"Deployment flow"},{"location":"terraform/#terraform-debug","text":"TF_LOG = DEBUG OS_DEBUG = 1 terraform apply","title":"Terraform debug"}]}